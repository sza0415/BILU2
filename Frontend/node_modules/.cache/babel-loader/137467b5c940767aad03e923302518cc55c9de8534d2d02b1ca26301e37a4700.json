{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, reactive, computed, onMounted } from 'vue';\nimport { Modal } from 'bootstrap';\nimport { searchRecords, getRecordTypes, downloadRecord as downloadRecordApi } from '../api/record';\nimport { getCaseTypes } from '../api/case';\nexport default {\n  name: 'RecordSearch',\n  setup() {\n    // 状态定义\n    const searchQuery = reactive({\n      keyword: '',\n      caseType: '',\n      recordType: '',\n      startDate: '',\n      endDate: '',\n      timeRange: 'all'\n    });\n    const searchResults = ref([]);\n    const loading = ref(false);\n    const totalItems = ref(0);\n    const totalPages = ref(0);\n    const currentPage = ref(1);\n    const pageSize = ref(10);\n    const showAdvancedSearch = ref(false);\n    const caseTypes = ref([]);\n    const recordTypes = ref([]);\n    const selectedRecord = ref(null);\n    const viewRecordModalInstance = ref(null);\n\n    // 计算属性\n    const displayedPages = computed(() => {\n      const pages = [];\n      const maxPagesToShow = 5;\n      let startPage = Math.max(1, currentPage.value - Math.floor(maxPagesToShow / 2));\n      let endPage = Math.min(totalPages.value, startPage + maxPagesToShow - 1);\n      if (endPage - startPage + 1 < maxPagesToShow) {\n        startPage = Math.max(1, endPage - maxPagesToShow + 1);\n      }\n      for (let i = startPage; i <= endPage; i++) {\n        pages.push(i);\n      }\n      return pages;\n    });\n\n    // 方法\n    const searchRecordsData = async page => {\n      loading.value = true;\n      try {\n        const response = await searchRecords({\n          keyword: searchQuery.keyword,\n          caseType: searchQuery.caseType,\n          recordType: searchQuery.recordType,\n          startDate: searchQuery.startDate,\n          endDate: searchQuery.endDate,\n          page: page,\n          pageSize: pageSize.value\n        });\n        if (response.code === 200) {\n          searchResults.value = response.data.records;\n          totalItems.value = response.data.total;\n          totalPages.value = response.data.pages;\n          currentPage.value = response.data.current;\n        } else {\n          console.error('搜索失败:', response.message);\n        }\n      } catch (error) {\n        console.error('搜索出错:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const searchRecords = page => {\n      currentPage.value = page;\n      searchRecordsData(page);\n    };\n    const changePage = page => {\n      if (page < 1 || page > totalPages.value) return;\n      searchRecords(page);\n    };\n    const changePageSize = () => {\n      searchRecords(1);\n    };\n    const setTimeRange = range => {\n      searchQuery.timeRange = range;\n      const today = new Date();\n\n      // 清除之前的日期范围\n      searchQuery.startDate = '';\n      searchQuery.endDate = '';\n      if (range === 'today') {\n        searchQuery.startDate = formatDateForInput(today);\n        searchQuery.endDate = formatDateForInput(today);\n      } else if (range === 'week') {\n        const startOfWeek = new Date(today);\n        startOfWeek.setDate(today.getDate() - today.getDay());\n        searchQuery.startDate = formatDateForInput(startOfWeek);\n        searchQuery.endDate = formatDateForInput(today);\n      } else if (range === 'month') {\n        const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);\n        searchQuery.startDate = formatDateForInput(startOfMonth);\n        searchQuery.endDate = formatDateForInput(today);\n      }\n      searchRecords(1);\n    };\n    const formatDateForInput = date => {\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const day = String(date.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    };\n    const loadCaseTypes = async () => {\n      try {\n        const response = await getCaseTypes();\n        if (response.code === 200) {\n          caseTypes.value = response.data.map(type => ({\n            value: type.code,\n            label: type.name\n          }));\n        }\n      } catch (error) {\n        console.error('获取案件类型失败:', error);\n      }\n    };\n    const loadRecordTypes = async () => {\n      try {\n        const response = await getRecordTypes();\n        if (response.code === 200) {\n          recordTypes.value = response.data.map(type => ({\n            value: type.code,\n            label: type.name\n          }));\n        }\n      } catch (error) {\n        console.error('获取笔录类型失败:', error);\n      }\n    };\n    const viewRecord = record => {\n      selectedRecord.value = record;\n      viewRecordModalInstance.value.show();\n    };\n    const downloadRecord = async record => {\n      try {\n        await downloadRecordApi(record.id);\n      } catch (error) {\n        console.error('下载笔录失败:', error);\n      }\n    };\n    const exportResults = () => {\n      // 实现导出功能\n      alert('导出功能待实现');\n    };\n    const formatDate = dateString => {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    };\n    const truncateText = (text, length) => {\n      if (!text) return '';\n      return text.length > length ? text.substring(0, length) + '...' : text;\n    };\n    const highlightKeyword = text => {\n      if (!text || !searchQuery.keyword) return text;\n      const regex = new RegExp(searchQuery.keyword, 'gi');\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\n    };\n    const getRecordTypeName = typeCode => {\n      const type = recordTypes.value.find(t => t.value === typeCode);\n      return type ? type.label : typeCode;\n    };\n    const getRecordTypeBadgeClass = typeCode => {\n      const typeMap = {\n        'WITNESS': 'bg-info',\n        'SUSPECT': 'bg-warning',\n        'VICTIM': 'bg-danger',\n        'OTHER': 'bg-secondary'\n      };\n      return typeMap[typeCode] || 'bg-secondary';\n    };\n\n    // 生命周期钩子\n    onMounted(() => {\n      // 初始化模态框\n      viewRecordModalInstance.value = new Modal(document.getElementById('viewRecordModal'));\n\n      // 加载数据\n      loadCaseTypes();\n      loadRecordTypes();\n      searchRecordsData(1);\n    });\n    return {\n      searchQuery,\n      searchResults,\n      loading,\n      totalItems,\n      totalPages,\n      currentPage,\n      pageSize,\n      showAdvancedSearch,\n      caseTypes,\n      recordTypes,\n      selectedRecord,\n      displayedPages,\n      searchRecords,\n      changePage,\n      changePageSize,\n      setTimeRange,\n      viewRecord,\n      downloadRecord,\n      exportResults,\n      formatDate,\n      truncateText,\n      highlightKeyword,\n      getRecordTypeName,\n      getRecordTypeBadgeClass\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","onMounted","Modal","searchRecords","getRecordTypes","downloadRecord","downloadRecordApi","getCaseTypes","name","setup","searchQuery","keyword","caseType","recordType","startDate","endDate","timeRange","searchResults","loading","totalItems","totalPages","currentPage","pageSize","showAdvancedSearch","caseTypes","recordTypes","selectedRecord","viewRecordModalInstance","displayedPages","pages","maxPagesToShow","startPage","Math","max","value","floor","endPage","min","i","push","searchRecordsData","page","response","code","data","records","total","current","console","error","message","changePage","changePageSize","setTimeRange","range","today","Date","formatDateForInput","startOfWeek","setDate","getDate","getDay","startOfMonth","getFullYear","getMonth","date","year","month","String","padStart","day","loadCaseTypes","map","type","label","loadRecordTypes","viewRecord","record","show","id","exportResults","alert","formatDate","dateString","toLocaleString","hour","minute","truncateText","text","length","substring","highlightKeyword","regex","RegExp","replace","match","getRecordTypeName","typeCode","find","t","getRecordTypeBadgeClass","typeMap","document","getElementById"],"sources":["/Users/sunziang/IdeaProjects/backend_bilu/bilu_backend2/src/views/Search.vue"],"sourcesContent":["<template>\n  <div class=\"container-fluid mt-4\">\n    <!-- 页面标题区域 -->\n    <div class=\"row mb-4\">\n      <div class=\"col-12\">\n        <div class=\"d-flex justify-content-between align-items-center\">\n          <div>\n            <h2 class=\"display-6 fw-bold text-primary mb-0\">\n              <i class=\"bi bi-search me-2\"></i>笔录搜索\n            </h2>\n            <p class=\"text-muted mb-0\">快速查找和检索笔录记录</p>\n          </div>\n          <div class=\"btn-group\">\n            <button class=\"btn btn-outline-primary\" @click=\"showAdvancedSearch = !showAdvancedSearch\">\n              <i class=\"bi bi-funnel me-2\"></i>高级搜索\n            </button>\n            <button class=\"btn btn-success\" @click=\"exportResults\" :disabled=\"searchResults.length === 0\">\n              <i class=\"bi bi-download me-2\"></i>导出结果\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 搜索表单区域 -->\n    <div class=\"row mb-4\">\n      <div class=\"col-12\">\n        <div class=\"card shadow-sm\">\n          <div class=\"card-body\">\n            <div class=\"row g-3\">\n              <div class=\"col-md-6\">\n                <div class=\"input-group\">\n                  <span class=\"input-group-text bg-light\">\n                    <i class=\"bi bi-search\"></i>\n                  </span>\n                  <input \n                    type=\"text\" \n                    class=\"form-control\" \n                    placeholder=\"输入关键词搜索笔录内容...\"\n                    v-model=\"searchQuery.keyword\"\n                    @keyup.enter=\"searchRecords(1)\"\n                  >\n                  <button class=\"btn btn-primary\" @click=\"searchRecords(1)\">\n                    搜索\n                  </button>\n                </div>\n              </div>\n              <div class=\"col-md-6 d-flex justify-content-end\">\n                <div class=\"btn-group\">\n                  <button \n                    class=\"btn\" \n                    :class=\"{'btn-primary': searchQuery.timeRange === 'all', 'btn-outline-primary': searchQuery.timeRange !== 'all'}\"\n                    @click=\"setTimeRange('all')\"\n                  >\n                    全部\n                  </button>\n                  <button \n                    class=\"btn\" \n                    :class=\"{'btn-primary': searchQuery.timeRange === 'today', 'btn-outline-primary': searchQuery.timeRange !== 'today'}\"\n                    @click=\"setTimeRange('today')\"\n                  >\n                    今天\n                  </button>\n                  <button \n                    class=\"btn\" \n                    :class=\"{'btn-primary': searchQuery.timeRange === 'week', 'btn-outline-primary': searchQuery.timeRange !== 'week'}\"\n                    @click=\"setTimeRange('week')\"\n                  >\n                    本周\n                  </button>\n                  <button \n                    class=\"btn\" \n                    :class=\"{'btn-primary': searchQuery.timeRange === 'month', 'btn-outline-primary': searchQuery.timeRange !== 'month'}\"\n                    @click=\"setTimeRange('month')\"\n                  >\n                    本月\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            <!-- 高级搜索选项 -->\n            <div class=\"row mt-3\" v-if=\"showAdvancedSearch\">\n              <div class=\"col-md-3 mb-3\">\n                <label class=\"form-label\">案件类型</label>\n                <select class=\"form-select\" v-model=\"searchQuery.caseType\">\n                  <option value=\"\">全部类型</option>\n                  <option v-for=\"type in caseTypes\" :key=\"type.value\" :value=\"type.value\">\n                    {{ type.label }}\n                  </option>\n                </select>\n              </div>\n              <div class=\"col-md-3 mb-3\">\n                <label class=\"form-label\">笔录类型</label>\n                <select class=\"form-select\" v-model=\"searchQuery.recordType\">\n                  <option value=\"\">全部类型</option>\n                  <option v-for=\"type in recordTypes\" :key=\"type.value\" :value=\"type.value\">\n                    {{ type.label }}\n                  </option>\n                </select>\n              </div>\n              <div class=\"col-md-3 mb-3\">\n                <label class=\"form-label\">开始日期</label>\n                <input type=\"date\" class=\"form-control\" v-model=\"searchQuery.startDate\">\n              </div>\n              <div class=\"col-md-3 mb-3\">\n                <label class=\"form-label\">结束日期</label>\n                <input type=\"date\" class=\"form-control\" v-model=\"searchQuery.endDate\">\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 搜索结果区域 -->\n    <div class=\"row\">\n      <div class=\"col-12\">\n        <div class=\"card shadow-sm\">\n          <div class=\"card-header bg-white py-3\">\n            <div class=\"d-flex justify-content-between align-items-center\">\n              <h5 class=\"mb-0\">搜索结果 <span class=\"badge bg-primary ms-2\">{{ totalItems }}</span></h5>\n              <div class=\"d-flex align-items-center\">\n                <span class=\"me-2\">每页显示:</span>\n                <select class=\"form-select form-select-sm\" style=\"width: 70px\" v-model=\"pageSize\" @change=\"changePageSize\">\n                  <option value=\"10\">10</option>\n                  <option value=\"20\">20</option>\n                  <option value=\"50\">50</option>\n                </select>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-body p-0\">\n            <div v-if=\"loading\" class=\"text-center py-5\">\n              <div class=\"spinner-border text-primary\" role=\"status\">\n                <span class=\"visually-hidden\">Loading...</span>\n              </div>\n              <p class=\"mt-2\">正在搜索，请稍候...</p>\n            </div>\n            <div v-else-if=\"searchResults.length === 0\" class=\"text-center py-5\">\n              <i class=\"bi bi-search display-1 text-muted\"></i>\n              <p class=\"mt-3\">暂无搜索结果，请尝试其他关键词或筛选条件</p>\n            </div>\n            <div v-else>\n              <div class=\"table-responsive\">\n                <table class=\"table table-hover align-middle mb-0\">\n                  <thead class=\"table-light\">\n                    <tr>\n                      <th scope=\"col\" width=\"5%\">#</th>\n                      <th scope=\"col\" width=\"15%\">案件编号</th>\n                      <th scope=\"col\" width=\"20%\">案件名称</th>\n                      <th scope=\"col\" width=\"15%\">笔录类型</th>\n                      <th scope=\"col\" width=\"15%\">创建时间</th>\n                      <th scope=\"col\" width=\"15%\">匹配内容</th>\n                      <th scope=\"col\" width=\"15%\">操作</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr v-for=\"(record, index) in searchResults\" :key=\"record.id\">\n                      <td>{{ (currentPage - 1) * pageSize + index + 1 }}</td>\n                      <td>\n                        <span class=\"badge bg-secondary\">{{ record.caseNumber }}</span>\n                      </td>\n                      <td>{{ record.caseName }}</td>\n                      <td>\n                        <span class=\"badge\" :class=\"getRecordTypeBadgeClass(record.recordType)\">\n                          {{ getRecordTypeName(record.recordType) }}\n                        </span>\n                      </td>\n                      <td>{{ formatDate(record.createTime) }}</td>\n                      <td>\n                        <span v-html=\"highlightKeyword(truncateText(record.matchContent, 30))\"></span>\n                      </td>\n                      <td>\n                        <div class=\"btn-group\">\n                          <button class=\"btn btn-sm btn-outline-primary\" @click=\"viewRecord(record)\">\n                            <i class=\"bi bi-eye\"></i>\n                          </button>\n                          <button class=\"btn btn-sm btn-outline-success\" @click=\"downloadRecord(record)\">\n                            <i class=\"bi bi-download\"></i>\n                          </button>\n                        </div>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer bg-white py-3\" v-if=\"totalPages > 0\">\n            <nav aria-label=\"Page navigation\">\n              <ul class=\"pagination justify-content-center mb-0\">\n                <li class=\"page-item\" :class=\"{ disabled: currentPage === 1 }\">\n                  <a class=\"page-link\" href=\"#\" @click.prevent=\"changePage(currentPage - 1)\">\n                    <i class=\"bi bi-chevron-left\"></i>\n                  </a>\n                </li>\n                <li class=\"page-item\" v-for=\"page in displayedPages\" :key=\"page\" :class=\"{ active: page === currentPage }\">\n                  <a class=\"page-link\" href=\"#\" @click.prevent=\"changePage(page)\">{{ page }}</a>\n                </li>\n                <li class=\"page-item\" :class=\"{ disabled: currentPage === totalPages }\">\n                  <a class=\"page-link\" href=\"#\" @click.prevent=\"changePage(currentPage + 1)\">\n                    <i class=\"bi bi-chevron-right\"></i>\n                  </a>\n                </li>\n              </ul>\n            </nav>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 查看笔录详情模态框 -->\n    <div class=\"modal fade\" id=\"viewRecordModal\" tabindex=\"-1\" aria-hidden=\"true\">\n      <div class=\"modal-dialog modal-dialog-centered modal-lg\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">笔录详情</h5>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n          </div>\n          <div class=\"modal-body\" v-if=\"selectedRecord\">\n            <div class=\"row mb-3\">\n              <div class=\"col-md-6\">\n                <p class=\"mb-1\"><strong>案件编号:</strong> {{ selectedRecord.caseNumber }}</p>\n                <p class=\"mb-1\"><strong>案件名称:</strong> {{ selectedRecord.caseName }}</p>\n              </div>\n              <div class=\"col-md-6\">\n                <p class=\"mb-1\"><strong>笔录类型:</strong> {{ getRecordTypeName(selectedRecord.recordType) }}</p>\n                <p class=\"mb-1\"><strong>创建时间:</strong> {{ formatDate(selectedRecord.createTime) }}</p>\n              </div>\n            </div>\n            <div class=\"card\">\n              <div class=\"card-header bg-light\">\n                <h6 class=\"mb-0\">笔录内容</h6>\n              </div>\n              <div class=\"card-body\">\n                <div class=\"record-content\" v-html=\"highlightKeyword(selectedRecord.content)\"></div>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">关闭</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"downloadRecord(selectedRecord)\">下载笔录</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { Modal } from 'bootstrap'\nimport { searchRecords, getRecordTypes, downloadRecord as downloadRecordApi } from '../api/record'\nimport { getCaseTypes } from '../api/case'\n\nexport default {\n  name: 'RecordSearch',\n  setup() {\n    // 状态定义\n    const searchQuery = reactive({\n      keyword: '',\n      caseType: '',\n      recordType: '',\n      startDate: '',\n      endDate: '',\n      timeRange: 'all'\n    })\n\n    const searchResults = ref([])\n    const loading = ref(false)\n    const totalItems = ref(0)\n    const totalPages = ref(0)\n    const currentPage = ref(1)\n    const pageSize = ref(10)\n    const showAdvancedSearch = ref(false)\n    const caseTypes = ref([])\n    const recordTypes = ref([])\n    const selectedRecord = ref(null)\n    const viewRecordModalInstance = ref(null)\n\n    // 计算属性\n    const displayedPages = computed(() => {\n      const pages = []\n      const maxPagesToShow = 5\n      let startPage = Math.max(1, currentPage.value - Math.floor(maxPagesToShow / 2))\n      let endPage = Math.min(totalPages.value, startPage + maxPagesToShow - 1)\n\n      if (endPage - startPage + 1 < maxPagesToShow) {\n        startPage = Math.max(1, endPage - maxPagesToShow + 1)\n      }\n\n      for (let i = startPage; i <= endPage; i++) {\n        pages.push(i)\n      }\n\n      return pages\n    })\n\n    // 方法\n    const searchRecordsData = async (page) => {\n      loading.value = true\n      try {\n        const response = await searchRecords({\n          keyword: searchQuery.keyword,\n          caseType: searchQuery.caseType,\n          recordType: searchQuery.recordType,\n          startDate: searchQuery.startDate,\n          endDate: searchQuery.endDate,\n          page: page,\n          pageSize: pageSize.value\n        })\n\n        if (response.code === 200) {\n          searchResults.value = response.data.records\n          totalItems.value = response.data.total\n          totalPages.value = response.data.pages\n          currentPage.value = response.data.current\n        } else {\n          console.error('搜索失败:', response.message)\n        }\n      } catch (error) {\n        console.error('搜索出错:', error)\n      } finally {\n        loading.value = false\n      }\n    }\n\n    const searchRecords = (page) => {\n      currentPage.value = page\n      searchRecordsData(page)\n    }\n\n    const changePage = (page) => {\n      if (page < 1 || page > totalPages.value) return\n      searchRecords(page)\n    }\n\n    const changePageSize = () => {\n      searchRecords(1)\n    }\n\n    const setTimeRange = (range) => {\n      searchQuery.timeRange = range\n      const today = new Date()\n      \n      // 清除之前的日期范围\n      searchQuery.startDate = ''\n      searchQuery.endDate = ''\n      \n      if (range === 'today') {\n        searchQuery.startDate = formatDateForInput(today)\n        searchQuery.endDate = formatDateForInput(today)\n      } else if (range === 'week') {\n        const startOfWeek = new Date(today)\n        startOfWeek.setDate(today.getDate() - today.getDay())\n        searchQuery.startDate = formatDateForInput(startOfWeek)\n        searchQuery.endDate = formatDateForInput(today)\n      } else if (range === 'month') {\n        const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\n        searchQuery.startDate = formatDateForInput(startOfMonth)\n        searchQuery.endDate = formatDateForInput(today)\n      }\n      \n      searchRecords(1)\n    }\n\n    const formatDateForInput = (date) => {\n      const year = date.getFullYear()\n      const month = String(date.getMonth() + 1).padStart(2, '0')\n      const day = String(date.getDate()).padStart(2, '0')\n      return `${year}-${month}-${day}`\n    }\n\n    const loadCaseTypes = async () => {\n      try {\n        const response = await getCaseTypes()\n        if (response.code === 200) {\n          caseTypes.value = response.data.map(type => ({\n            value: type.code,\n            label: type.name\n          }))\n        }\n      } catch (error) {\n        console.error('获取案件类型失败:', error)\n      }\n    }\n\n    const loadRecordTypes = async () => {\n      try {\n        const response = await getRecordTypes()\n        if (response.code === 200) {\n          recordTypes.value = response.data.map(type => ({\n            value: type.code,\n            label: type.name\n          }))\n        }\n      } catch (error) {\n        console.error('获取笔录类型失败:', error)\n      }\n    }\n\n    const viewRecord = (record) => {\n      selectedRecord.value = record\n      viewRecordModalInstance.value.show()\n    }\n\n    const downloadRecord = async (record) => {\n      try {\n        await downloadRecordApi(record.id)\n      } catch (error) {\n        console.error('下载笔录失败:', error)\n      }\n    }\n\n    const exportResults = () => {\n      // 实现导出功能\n      alert('导出功能待实现')\n    }\n\n    const formatDate = (dateString) => {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      })\n    }\n\n    const truncateText = (text, length) => {\n      if (!text) return ''\n      return text.length > length ? text.substring(0, length) + '...' : text\n    }\n\n    const highlightKeyword = (text) => {\n      if (!text || !searchQuery.keyword) return text\n      const regex = new RegExp(searchQuery.keyword, 'gi')\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`)\n    }\n\n    const getRecordTypeName = (typeCode) => {\n      const type = recordTypes.value.find(t => t.value === typeCode)\n      return type ? type.label : typeCode\n    }\n\n    const getRecordTypeBadgeClass = (typeCode) => {\n      const typeMap = {\n        'WITNESS': 'bg-info',\n        'SUSPECT': 'bg-warning',\n        'VICTIM': 'bg-danger',\n        'OTHER': 'bg-secondary'\n      }\n      return typeMap[typeCode] || 'bg-secondary'\n    }\n\n    // 生命周期钩子\n    onMounted(() => {\n      // 初始化模态框\n      viewRecordModalInstance.value = new Modal(document.getElementById('viewRecordModal'))\n      \n      // 加载数据\n      loadCaseTypes()\n      loadRecordTypes()\n      searchRecordsData(1)\n    })\n\n    return {\n      searchQuery,\n      searchResults,\n      loading,\n      totalItems,\n      totalPages,\n      currentPage,\n      pageSize,\n      showAdvancedSearch,\n      caseTypes,\n      recordTypes,\n      selectedRecord,\n      displayedPages,\n      searchRecords,\n      changePage,\n      changePageSize,\n      setTimeRange,\n      viewRecord,\n      downloadRecord,\n      exportResults,\n      formatDate,\n      truncateText,\n      highlightKeyword,\n      getRecordTypeName,\n      getRecordTypeBadgeClass\n    }\n  }\n}\n</script>\n\n<style scoped>\n.highlight {\n  background-color: #ffff00;\n  font-weight: bold;\n}\n\n.record-content {\n  max-height: 400px;\n  overflow-y: auto;\n  line-height: 1.6;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}