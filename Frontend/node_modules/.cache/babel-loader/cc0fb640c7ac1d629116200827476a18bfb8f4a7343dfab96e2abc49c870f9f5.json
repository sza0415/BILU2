{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { searchRecords, getRecordList, deleteRecord } from '@/api/record';\nimport { Modal } from 'bootstrap';\nexport default {\n  name: 'RecordSearch',\n  data() {\n    return {\n      searchParams: {\n        q: '',\n        start_date: '',\n        end_date: '',\n        location: '',\n        assistant: '',\n        inquirer: ''\n      },\n      results: [],\n      relatedRecords: [],\n      recentRecords: [],\n      advancedSearchVisible: false,\n      searchSubmitted: false,\n      recordToDelete: {\n        id: null,\n        name: ''\n      },\n      deleteModal: null\n    };\n  },\n  mounted() {\n    // 初始化删除确认模态框\n    this.deleteModal = new Modal(document.getElementById('deleteConfirmModal'));\n\n    // 加载最近笔录\n    this.loadRecentRecords();\n\n    // 检查URL参数，如果有搜索参数，则自动展开高级搜索选项\n    const query = this.$route.query;\n    if (query.q || query.start_date || query.end_date || query.location || query.assistant || query.inquirer) {\n      this.searchParams = {\n        q: query.q || '',\n        start_date: query.start_date || '',\n        end_date: query.end_date || '',\n        location: query.location || '',\n        assistant: query.assistant || '',\n        inquirer: query.inquirer || ''\n      };\n      this.advancedSearchVisible = !!(query.start_date || query.end_date || query.location || query.assistant || query.inquirer);\n      this.searchRecords();\n    }\n  },\n  methods: {\n    // 切换高级搜索选项的显示/隐藏\n    toggleAdvancedSearch() {\n      this.advancedSearchVisible = !this.advancedSearchVisible;\n    },\n    // 搜索笔录\n    async searchRecords() {\n      this.searchSubmitted = true;\n      try {\n        console.log('搜索参数:', this.searchParams);\n        const response = await searchRecords(this.searchParams);\n        console.log('搜索结果:', response);\n\n        // 后端返回的数据结构是 {code, message, data}，其中data是PageResult对象\n        // PageResult对象包含 {total, pages, current, size, records, extra}\n        if (response.data && response.data.code === 200 && response.data.data) {\n          console.log('搜索结果records:', response.data.data.records);\n          this.results = response.data.data.records || [];\n          this.relatedRecords = []; // 相关记录暂时为空，可以根据需要从后端获取\n          console.log('设置结果后this.results:', this.results);\n        } else {\n          console.error('搜索笔录返回数据格式不正确:', response.data);\n          this.results = [];\n          this.relatedRecords = [];\n        }\n\n        // 更新URL参数\n        this.updateUrlParams();\n      } catch (error) {\n        console.error('搜索笔录失败:', error);\n        this.results = [];\n        this.relatedRecords = [];\n      }\n    },\n    // 加载最近笔录\n    async loadRecentRecords() {\n      try {\n        const response = await getRecordList();\n        // 后端返回的数据结构是 {code, message, data}，其中data是记录数组\n        if (response.data && response.data.code === 200 && response.data.data) {\n          this.recentRecords = response.data.data.slice(0, 5); // 只显示最近5条\n        } else {\n          console.error('加载最近笔录返回数据格式不正确:', response.data);\n          this.recentRecords = [];\n        }\n      } catch (error) {\n        console.error('加载最近笔录失败:', error);\n        this.recentRecords = [];\n      }\n    },\n    // 查看笔录详情\n    viewRecordDetail(id) {\n      this.$router.push(`/record/${id}`);\n    },\n    // 编辑笔录\n    editRecord(id) {\n      this.$router.push(`/record/edit/${id}`);\n    },\n    // 确认删除笔录\n    confirmDelete(id, name) {\n      this.recordToDelete = {\n        id,\n        name\n      };\n      this.deleteModal.show();\n    },\n    // 删除笔录\n    async deleteRecord() {\n      try {\n        await deleteRecord(this.recordToDelete.id);\n        // 从结果列表中移除已删除的笔录\n        this.results = this.results.filter(record => record.id !== this.recordToDelete.id);\n        this.relatedRecords = this.relatedRecords.filter(record => record.id !== this.recordToDelete.id);\n        this.recentRecords = this.recentRecords.filter(record => record.id !== this.recordToDelete.id);\n\n        // 关闭模态框\n        this.deleteModal.hide();\n\n        // 显示成功消息\n        this.$bvToast.toast('笔录删除成功', {\n          title: '操作成功',\n          variant: 'success',\n          solid: true\n        });\n      } catch (error) {\n        console.error('删除笔录失败:', error);\n        this.$bvToast.toast(`删除失败: ${error.message || '未知错误'}`, {\n          title: '操作失败',\n          variant: 'danger',\n          solid: true\n        });\n      }\n    },\n    // 更新URL参数\n    updateUrlParams() {\n      const query = {};\n      if (this.searchParams.q) query.q = this.searchParams.q;\n      if (this.searchParams.start_date) query.start_date = this.searchParams.start_date;\n      if (this.searchParams.end_date) query.end_date = this.searchParams.end_date;\n      if (this.searchParams.location) query.location = this.searchParams.location;\n      if (this.searchParams.assistant) query.assistant = this.searchParams.assistant;\n      if (this.searchParams.inquirer) query.inquirer = this.searchParams.inquirer;\n      this.$router.replace({\n        query\n      });\n    },\n    // 格式化日期\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      });\n    },\n    // 格式化时间\n    formatTime(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleTimeString('zh-CN', {\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    },\n    // 截断文本\n    truncateText(text, length) {\n      if (!text) return '';\n      return text.length > length ? text.substring(0, length) + '...' : text;\n    },\n    // 高亮搜索关键词\n    highlightText(text) {\n      if (!text || !this.searchParams.q) return text;\n      const regex = new RegExp(this.searchParams.q, 'gi');\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`);\n    }\n  }\n};","map":{"version":3,"names":["searchRecords","getRecordList","deleteRecord","Modal","name","data","searchParams","q","start_date","end_date","location","assistant","inquirer","results","relatedRecords","recentRecords","advancedSearchVisible","searchSubmitted","recordToDelete","id","deleteModal","mounted","document","getElementById","loadRecentRecords","query","$route","methods","toggleAdvancedSearch","console","log","response","code","records","error","updateUrlParams","slice","viewRecordDetail","$router","push","editRecord","confirmDelete","show","filter","record","hide","$bvToast","toast","title","variant","solid","message","replace","formatDate","dateString","date","Date","toLocaleDateString","year","month","day","formatTime","toLocaleTimeString","hour","minute","truncateText","text","length","substring","highlightText","regex","RegExp","match"],"sources":["/Users/sunziang/IdeaProjects/backend_bilu/bilu_backend2/src/views/RecordSearch.vue"],"sourcesContent":["<template>\n  <div class=\"container mt-4\">\n    <!-- 页面标题区域 -->\n    <div class=\"row mb-4\">\n      <div class=\"col-12 text-center\">\n        <h2 class=\"display-5 fw-bold text-primary\">案件笔录搜索</h2>\n        <p class=\"text-muted\">快速查找和浏览所有案件笔录</p>\n      </div>\n    </div>\n    \n    <!-- 搜索表单 -->\n    <div class=\"row justify-content-center mb-5\">\n      <div class=\"col-md-8\">\n        <form @submit.prevent=\"searchRecords\" class=\"search-form\">\n          <div class=\"input-group input-group-lg shadow-sm mb-3\">\n            <input \n              type=\"text\" \n              v-model=\"searchParams.q\" \n              class=\"form-control border-0\" \n              placeholder=\"搜索笔录名称、地点、询问员、被询问人或内容...\"\n            >\n            <button class=\"btn btn-primary px-4\" type=\"submit\">\n              <i class=\"bi bi-search me-2\"></i>搜索\n            </button>\n          </div>\n          \n          <!-- 高级搜索选项切换按钮 -->\n          <div class=\"text-center mb-3\">\n            <button \n              type=\"button\" \n              class=\"btn btn-sm btn-outline-secondary\" \n              @click=\"toggleAdvancedSearch\"\n            >\n              <i class=\"bi\" :class=\"advancedSearchVisible ? 'bi-chevron-up' : 'bi-sliders'\"></i>\n              {{ advancedSearchVisible ? '收起高级检索' : '高级检索选项' }}\n            </button>\n          </div>\n          \n          <!-- 高级搜索选项 -->\n          <div \n            class=\"card p-3 shadow-sm mb-3\" \n            v-show=\"advancedSearchVisible\"\n          >\n            <div class=\"row g-3\">\n              <!-- 时间范围 -->\n              <div class=\"col-md-6\">\n                <label class=\"form-label\"><i class=\"bi bi-calendar-range text-primary me-1\"></i>询问时间范围</label>\n                <div class=\"input-group input-group-sm\">\n                  <span class=\"input-group-text\">从</span>\n                  <input \n                    type=\"date\" \n                    v-model=\"searchParams.start_date\" \n                    class=\"form-control\"\n                  >\n                  <span class=\"input-group-text\">至</span>\n                  <input \n                    type=\"date\" \n                    v-model=\"searchParams.end_date\" \n                    class=\"form-control\"\n                  >\n                </div>\n              </div>\n              \n              <!-- 询问地点 -->\n              <div class=\"col-md-6\">\n                <label class=\"form-label\"><i class=\"bi bi-geo-alt text-danger me-1\"></i>询问地点</label>\n                <input \n                  type=\"text\" \n                  v-model=\"searchParams.location\" \n                  class=\"form-control form-control-sm\" \n                  placeholder=\"输入地点关键词\"\n                >\n              </div>\n              \n              <!-- 询问员 -->\n              <div class=\"col-md-6\">\n                <label class=\"form-label\"><i class=\"bi bi-person text-primary me-1\"></i>询问员</label>\n                <input \n                  type=\"text\" \n                  v-model=\"searchParams.assistant\" \n                  class=\"form-control form-control-sm\" \n                  placeholder=\"输入询问员姓名\"\n                >\n              </div>\n              \n              <!-- 被询问人 -->\n              <div class=\"col-md-6\">\n                <label class=\"form-label\"><i class=\"bi bi-person-badge text-success me-1\"></i>被询问人</label>\n                <input \n                  type=\"text\" \n                  v-model=\"searchParams.inquirer\" \n                  class=\"form-control form-control-sm\" \n                  placeholder=\"输入被询问人姓名\"\n                >\n              </div>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n    \n    <!-- 搜索结果 -->\n    <div v-if=\"results.length > 0\">\n      <div class=\"results-header d-flex justify-content-between align-items-center mb-4\">\n        <h3 class=\"fw-bold\"><i class=\"bi bi-file-earmark-text me-2\"></i>搜索结果 \n          <span class=\"badge bg-primary rounded-pill ms-2\">{{ results.length }}</span>\n        </h3>\n        <div class=\"text-muted\">找到 {{ results.length }} 条匹配笔录</div>\n      </div>\n      \n      <div class=\"row g-4\">\n        <div \n          v-for=\"record in results\" \n          :key=\"record.id\" \n          class=\"col-md-6 mb-3 search-result-item\"\n        >\n          <div class=\"card h-100 border-0 shadow-sm hover-card\">\n            <div class=\"card-header bg-gradient d-flex justify-content-between align-items-center\">\n              <h5 class=\"card-title mb-0 text-primary\">{{ highlightText(record.record_name) }}</h5>\n              <span class=\"badge bg-primary rounded-pill\">{{ formatDate(record.inquiry_time) }}</span>\n            </div>\n            <div class=\"card-body\">\n              <div class=\"mb-3\">\n                <div class=\"d-flex mb-2\">\n                  <div class=\"icon-box me-2\"><i class=\"bi bi-geo-alt-fill text-danger\"></i></div>\n                  <div><strong>询问地点:</strong> {{ highlightText(record.inquiry_address) }}</div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"icon-box me-2\"><i class=\"bi bi-person-fill text-primary\"></i></div>\n                  <div><strong>询问员:</strong> {{ highlightText(record.assistant_name) }}</div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"icon-box me-2\"><i class=\"bi bi-person-badge text-success\"></i></div>\n                  <div><strong>被询问人:</strong> {{ highlightText(record.inquirer_name) }}</div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"icon-box me-2\"><i class=\"bi bi-credit-card-2-front text-warning\"></i></div>\n                  <div><strong>身份证号:</strong> {{ highlightText(record.inquiry_id) }}</div>\n                </div>\n              </div>\n              <div class=\"content-preview p-3 bg-light rounded\">\n                <i class=\"bi bi-quote me-2 text-secondary\"></i>\n                <span class=\"fst-italic\">{{ truncateText(highlightText(record.text_content), 100) }}</span>\n              </div>\n            </div>\n            <div class=\"card-footer bg-white border-0 text-end\">\n              <button \n                @click=\"viewRecordDetail(record.id)\" \n                class=\"btn btn-outline-primary btn-sm\"\n              >\n                <i class=\"bi bi-eye me-1\"></i>查看详情\n              </button>\n              <button \n                @click=\"editRecord(record.id)\" \n                class=\"btn btn-outline-warning btn-sm ms-1\"\n              >\n                <i class=\"bi bi-pencil me-1\"></i>修改\n              </button>\n              <button \n                @click=\"confirmDelete(record.id, record.record_name)\" \n                class=\"btn btn-outline-danger btn-sm ms-1\"\n              >\n                <i class=\"bi bi-trash me-1\"></i>删除\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 相关记录 -->\n      <div v-if=\"relatedRecords.length > 0\">\n        <div class=\"related-header mt-5 mb-4\">\n          <h3 class=\"fw-bold\"><i class=\"bi bi-link-45deg me-2\"></i>相关笔录</h3>\n          <div class=\"border-bottom border-2 border-primary\" style=\"width: 50px;\"></div>\n        </div>\n        <div class=\"row g-4\">\n          <div \n            v-for=\"record in relatedRecords\" \n            :key=\"record.id\" \n            class=\"col-md-4 mb-3 related-item\"\n          >\n            <div class=\"card h-100 border-0 shadow-sm hover-card\">\n              <div class=\"card-header bg-light\">\n                <h5 class=\"card-title text-secondary\">{{ highlightText(record.record_name) }}</h5>\n              </div>\n              <div class=\"card-body\">\n                <div class=\"d-flex align-items-center mb-2\">\n                  <i class=\"bi bi-person-fill text-primary me-2\"></i>\n                  <div><strong>询问员:</strong> {{ highlightText(record.assistant_name) }}</div>\n                </div>\n                <div class=\"d-flex align-items-center mb-2\">\n                  <i class=\"bi bi-person-badge text-success me-2\"></i>\n                  <div><strong>被询问人:</strong> {{ highlightText(record.inquirer_name) }}</div>\n                </div>\n                <div class=\"d-flex align-items-center\">\n                  <i class=\"bi bi-calendar-date text-info me-2\"></i>\n                  <div><strong>时间:</strong> {{ formatDate(record.inquiry_time) }}</div>\n                </div>\n              </div>\n              <div class=\"card-footer bg-white border-0 text-end\">\n                <button \n                  @click=\"viewRecordDetail(record.id)\" \n                  class=\"btn btn-outline-secondary btn-sm\"\n                >\n                  <i class=\"bi bi-eye me-1\"></i>查看详情\n                </button>\n                <button \n                  @click=\"editRecord(record.id)\" \n                  class=\"btn btn-outline-warning btn-sm ms-1\"\n                >\n                  <i class=\"bi bi-pencil me-1\"></i>修改\n                </button>\n                <button \n                  @click=\"confirmDelete(record.id, record.record_name)\" \n                  class=\"btn btn-outline-danger btn-sm ms-1\"\n                >\n                  <i class=\"bi bi-trash me-1\"></i>删除\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-else-if=\"searchSubmitted\">\n      <div class=\"alert alert-info shadow-sm border-0 d-flex align-items-center\">\n        <i class=\"bi bi-info-circle-fill me-3 fs-4\"></i>\n        <div>没有找到与 \"<strong>{{ searchParams.q }}</strong>\" 相关的笔录。</div>\n      </div>\n    </div>\n    <div v-else>\n      <div class=\"empty-state text-center py-3\">\n        <i class=\"bi bi-search fs-1 text-secondary mb-2 d-block\"></i>\n        <h5 class=\"text-secondary\">请输入搜索关键词</h5>\n        <p class=\"text-muted small\">输入关键词以查找相关案件笔录</p>\n      </div>\n      \n      <!-- 最近笔录 - 时间线形式 -->\n      <div v-if=\"recentRecords.length > 0\" class=\"recent-records mt-5\">\n        <div class=\"recent-header mb-4\">\n          <h3 class=\"fw-bold\"><i class=\"bi bi-clock-history me-2\"></i>最近笔录</h3>\n          <div class=\"border-bottom border-2 border-primary\" style=\"width: 50px;\"></div>\n        </div>\n        <div class=\"timeline-container\">\n          <div \n            v-for=\"record in recentRecords\" \n            :key=\"record.id\" \n            class=\"timeline-item recent-item\"\n          >\n            <div class=\"timeline-dot\">\n              <i class=\"bi bi-file-earmark-text\"></i>\n            </div>\n            <div class=\"timeline-date\">\n              <span>{{ formatDate(record.inquiry_time) }}</span>\n              <span class=\"timeline-time\">{{ formatTime(record.inquiry_time) }}</span>\n            </div>\n            <div class=\"timeline-content\">\n              <div class=\"card border-0 shadow-sm hover-card\">\n                <div class=\"card-header bg-light d-flex justify-content-between align-items-center\">\n                  <h5 class=\"card-title text-primary mb-0\">{{ record.record_name }}</h5>\n                  <span class=\"badge bg-primary rounded-pill\">{{ record.case_name }}</span>\n                </div>\n                <div class=\"card-body\">\n                  <div class=\"row\">\n                    <div class=\"col-md-6\">\n                      <div class=\"d-flex align-items-center mb-2\">\n                        <i class=\"bi bi-person-fill text-primary me-2\"></i>\n                        <div><strong>询问员:</strong> {{ record.assistant_name }}</div>\n                      </div>\n                      <div class=\"d-flex align-items-center mb-2\">\n                        <i class=\"bi bi-person-badge text-success me-2\"></i>\n                        <div><strong>被询问人:</strong> {{ record.inquirer_name }}</div>\n                      </div>\n                    </div>\n                    <div class=\"col-md-6\">\n                      <div class=\"d-flex align-items-center mb-2\">\n                        <i class=\"bi bi-geo-alt-fill text-danger me-2\"></i>\n                        <div><strong>询问地点:</strong> {{ record.inquiry_address }}</div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"card-footer bg-white border-0 text-end\">\n                  <button \n                    @click=\"viewRecordDetail(record.id)\" \n                    class=\"btn btn-outline-primary btn-sm\"\n                  >\n                    <i class=\"bi bi-eye me-1\"></i>查看详情\n                  </button>\n                  <button \n                    @click=\"editRecord(record.id)\" \n                    class=\"btn btn-outline-warning btn-sm ms-1\"\n                  >\n                    <i class=\"bi bi-pencil me-1\"></i>修改\n                  </button>\n                  <button \n                    @click=\"confirmDelete(record.id, record.record_name)\" \n                    class=\"btn btn-outline-danger btn-sm ms-1\"\n                  >\n                    <i class=\"bi bi-trash me-1\"></i>删除\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 删除确认模态框 -->\n    <div class=\"modal fade\" id=\"deleteConfirmModal\" tabindex=\"-1\" aria-labelledby=\"deleteConfirmModalLabel\" aria-hidden=\"true\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header bg-danger text-white\">\n            <h5 class=\"modal-title\" id=\"deleteConfirmModalLabel\">确认删除</h5>\n            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <p>您确定要删除笔录 <strong>{{ recordToDelete.name }}</strong> 吗？</p>\n            <p class=\"text-danger\"><i class=\"bi bi-exclamation-triangle-fill me-2\"></i>此操作不可逆，删除后数据将无法恢复！</p>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteRecord\">\n              <i class=\"bi bi-trash me-1\"></i>确认删除\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { searchRecords, getRecordList, deleteRecord } from '@/api/record'\nimport { Modal } from 'bootstrap'\n\nexport default {\n  name: 'RecordSearch',\n  data() {\n    return {\n      searchParams: {\n        q: '',\n        start_date: '',\n        end_date: '',\n        location: '',\n        assistant: '',\n        inquirer: ''\n      },\n      results: [],\n      relatedRecords: [],\n      recentRecords: [],\n      advancedSearchVisible: false,\n      searchSubmitted: false,\n      recordToDelete: {\n        id: null,\n        name: ''\n      },\n      deleteModal: null\n    }\n  },\n  mounted() {\n    // 初始化删除确认模态框\n    this.deleteModal = new Modal(document.getElementById('deleteConfirmModal'))\n    \n    // 加载最近笔录\n    this.loadRecentRecords()\n    \n    // 检查URL参数，如果有搜索参数，则自动展开高级搜索选项\n    const query = this.$route.query\n    if (query.q || query.start_date || query.end_date || \n        query.location || query.assistant || query.inquirer) {\n      this.searchParams = {\n        q: query.q || '',\n        start_date: query.start_date || '',\n        end_date: query.end_date || '',\n        location: query.location || '',\n        assistant: query.assistant || '',\n        inquirer: query.inquirer || ''\n      }\n      this.advancedSearchVisible = !!(query.start_date || query.end_date || \n                                     query.location || query.assistant || \n                                     query.inquirer)\n      this.searchRecords()\n    }\n  },\n  methods: {\n    // 切换高级搜索选项的显示/隐藏\n    toggleAdvancedSearch() {\n      this.advancedSearchVisible = !this.advancedSearchVisible\n    },\n    \n    // 搜索笔录\n    async searchRecords() {\n      this.searchSubmitted = true\n      try {\n        console.log('搜索参数:', this.searchParams)\n        const response = await searchRecords(this.searchParams)\n        console.log('搜索结果:', response)\n        \n        // 后端返回的数据结构是 {code, message, data}，其中data是PageResult对象\n        // PageResult对象包含 {total, pages, current, size, records, extra}\n        if (response.data && response.data.code === 200 && response.data.data) {\n          console.log('搜索结果records:', response.data.data.records)\n          this.results = response.data.data.records || []\n          this.relatedRecords = [] // 相关记录暂时为空，可以根据需要从后端获取\n          console.log('设置结果后this.results:', this.results)\n        } else {\n          console.error('搜索笔录返回数据格式不正确:', response.data)\n          this.results = []\n          this.relatedRecords = []\n        }\n        \n        // 更新URL参数\n        this.updateUrlParams()\n      } catch (error) {\n        console.error('搜索笔录失败:', error)\n        this.results = []\n        this.relatedRecords = []\n      }\n    },\n    \n    // 加载最近笔录\n    async loadRecentRecords() {\n      try {\n        const response = await getRecordList()\n        // 后端返回的数据结构是 {code, message, data}，其中data是记录数组\n        if (response.data && response.data.code === 200 && response.data.data) {\n          this.recentRecords = response.data.data.slice(0, 5) // 只显示最近5条\n        } else {\n          console.error('加载最近笔录返回数据格式不正确:', response.data)\n          this.recentRecords = []\n        }\n      } catch (error) {\n        console.error('加载最近笔录失败:', error)\n        this.recentRecords = []\n      }\n    },\n    \n    // 查看笔录详情\n    viewRecordDetail(id) {\n      this.$router.push(`/record/${id}`)\n    },\n    \n    // 编辑笔录\n    editRecord(id) {\n      this.$router.push(`/record/edit/${id}`)\n    },\n    \n    // 确认删除笔录\n    confirmDelete(id, name) {\n      this.recordToDelete = {\n        id,\n        name\n      }\n      this.deleteModal.show()\n    },\n    \n    // 删除笔录\n    async deleteRecord() {\n      try {\n        await deleteRecord(this.recordToDelete.id)\n        // 从结果列表中移除已删除的笔录\n        this.results = this.results.filter(record => record.id !== this.recordToDelete.id)\n        this.relatedRecords = this.relatedRecords.filter(record => record.id !== this.recordToDelete.id)\n        this.recentRecords = this.recentRecords.filter(record => record.id !== this.recordToDelete.id)\n        \n        // 关闭模态框\n        this.deleteModal.hide()\n        \n        // 显示成功消息\n        this.$bvToast.toast('笔录删除成功', {\n          title: '操作成功',\n          variant: 'success',\n          solid: true\n        })\n      } catch (error) {\n        console.error('删除笔录失败:', error)\n        this.$bvToast.toast(`删除失败: ${error.message || '未知错误'}`, {\n          title: '操作失败',\n          variant: 'danger',\n          solid: true\n        })\n      }\n    },\n    \n    // 更新URL参数\n    updateUrlParams() {\n      const query = {}\n      if (this.searchParams.q) query.q = this.searchParams.q\n      if (this.searchParams.start_date) query.start_date = this.searchParams.start_date\n      if (this.searchParams.end_date) query.end_date = this.searchParams.end_date\n      if (this.searchParams.location) query.location = this.searchParams.location\n      if (this.searchParams.assistant) query.assistant = this.searchParams.assistant\n      if (this.searchParams.inquirer) query.inquirer = this.searchParams.inquirer\n      \n      this.$router.replace({ query })\n    },\n    \n    // 格式化日期\n    formatDate(dateString) {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' })\n    },\n    \n    // 格式化时间\n    formatTime(dateString) {\n      if (!dateString) return ''\n      const date = new Date(dateString)\n      return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n    },\n    \n    // 截断文本\n    truncateText(text, length) {\n      if (!text) return ''\n      return text.length > length ? text.substring(0, length) + '...' : text\n    },\n    \n    // 高亮搜索关键词\n    highlightText(text) {\n      if (!text || !this.searchParams.q) return text\n      const regex = new RegExp(this.searchParams.q, 'gi')\n      return text.replace(regex, match => `<span class=\"highlight\">${match}</span>`)\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 搜索表单样式 */\n.search-form .form-control:focus {\n  box-shadow: none;\n  border-color: #0d6efd;\n}\n\n/* 卡片悬停效果 */\n.hover-card {\n  transition: all 0.3s ease;\n}\n\n.hover-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;\n}\n\n/* 卡片头部渐变背景 */\n.card-header.bg-gradient {\n  background: linear-gradient(to right, #f8f9fa, #e9ecef);\n  border-bottom: none;\n}\n\n/* 图标样式 */\n.icon-box {\n  width: 24px;\n  text-align: center;\n}\n\n/* 内容预览区域 */\n.content-preview {\n  background-color: rgba(0,0,0,0.02);\n  border-left: 3px solid #0d6efd;\n}\n\n/* 搜索结果、相关项目和最近项目的动画效果 */\n.search-result-item, .related-item, .recent-item {\n  animation: fadeIn 0.5s ease-in-out;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(20px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n/* 空状态样式 */\n.empty-state {\n  padding: 3rem;\n  background-color: #f8f9fa;\n  border-radius: 1rem;\n}\n\n/* 时间线样式 */\n.timeline-container {\n  position: relative;\n  padding-left: 30px;\n  margin-left: 90px;\n}\n\n.timeline-container::before {\n  content: '';\n  position: absolute;\n  left: 15px;\n  top: 0;\n  bottom: 0;\n  width: 2px;\n  background: #0d6efd;\n}\n\n.timeline-item {\n  position: relative;\n  margin-bottom: 20px;\n}\n\n.timeline-dot {\n  position: absolute;\n  left: -30px;\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  background-color: #0d6efd;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1;\n  box-shadow: 0 0 0 4px rgba(13, 110, 253, 0.2);\n  font-size: 0.8rem;\n}\n\n.timeline-date {\n  position: absolute;\n  left: -120px;\n  top: 5px;\n  width: 85px;\n  text-align: right;\n  color: #6c757d;\n  font-weight: bold;\n  display: flex;\n  flex-direction: column;\n}\n\n.timeline-time {\n  font-size: 0.75rem;\n  color: #adb5bd;\n}\n\n.timeline-content {\n  padding-left: 15px;\n  padding-bottom: 5px;\n}\n\n/* 高亮样式 */\n.highlight {\n  background-color: rgba(255, 193, 7, 0.3);\n  padding: 0 2px;\n  border-radius: 2px;\n  font-weight: bold;\n}\n\n/* 响应式时间线样式 */\n@media (max-width: 768px) {\n  .timeline-container {\n    margin-left: 50px;\n    padding-left: 25px;\n  }\n  \n  .timeline-container::before {\n    left: 40px;\n  }\n  \n  .timeline-dot {\n    width: 25px;\n    height: 25px;\n    left: -25px;\n    font-size: 0.7rem;\n  }\n  \n  .timeline-date {\n    left: -85px;\n    width: 75px;\n    font-size: 0.85rem;\n  }\n  \n  .timeline-time {\n    font-size: 0.7rem;\n  }\n  \n  .timeline-content {\n    padding-left: 10px;\n  }\n}\n</style>"],"mappings":";;;AA8UA,SAASA,aAAa,EAAEC,aAAa,EAAEC,YAAW,QAAS,cAAa;AACxE,SAASC,KAAI,QAAS,WAAU;AAEhC,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,YAAY,EAAE;QACZC,CAAC,EAAE,EAAE;QACLC,UAAU,EAAE,EAAE;QACdC,QAAQ,EAAE,EAAE;QACZC,QAAQ,EAAE,EAAE;QACZC,SAAS,EAAE,EAAE;QACbC,QAAQ,EAAE;MACZ,CAAC;MACDC,OAAO,EAAE,EAAE;MACXC,cAAc,EAAE,EAAE;MAClBC,aAAa,EAAE,EAAE;MACjBC,qBAAqB,EAAE,KAAK;MAC5BC,eAAe,EAAE,KAAK;MACtBC,cAAc,EAAE;QACdC,EAAE,EAAE,IAAI;QACRf,IAAI,EAAE;MACR,CAAC;MACDgB,WAAW,EAAE;IACf;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,CAACD,WAAU,GAAI,IAAIjB,KAAK,CAACmB,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC;;IAE1E;IACA,IAAI,CAACC,iBAAiB,CAAC;;IAEvB;IACA,MAAMC,KAAI,GAAI,IAAI,CAACC,MAAM,CAACD,KAAI;IAC9B,IAAIA,KAAK,CAAClB,CAAA,IAAKkB,KAAK,CAACjB,UAAS,IAAKiB,KAAK,CAAChB,QAAO,IAC5CgB,KAAK,CAACf,QAAO,IAAKe,KAAK,CAACd,SAAQ,IAAKc,KAAK,CAACb,QAAQ,EAAE;MACvD,IAAI,CAACN,YAAW,GAAI;QAClBC,CAAC,EAAEkB,KAAK,CAAClB,CAAA,IAAK,EAAE;QAChBC,UAAU,EAAEiB,KAAK,CAACjB,UAAS,IAAK,EAAE;QAClCC,QAAQ,EAAEgB,KAAK,CAAChB,QAAO,IAAK,EAAE;QAC9BC,QAAQ,EAAEe,KAAK,CAACf,QAAO,IAAK,EAAE;QAC9BC,SAAS,EAAEc,KAAK,CAACd,SAAQ,IAAK,EAAE;QAChCC,QAAQ,EAAEa,KAAK,CAACb,QAAO,IAAK;MAC9B;MACA,IAAI,CAACI,qBAAoB,GAAI,CAAC,EAAES,KAAK,CAACjB,UAAS,IAAKiB,KAAK,CAAChB,QAAO,IAClCgB,KAAK,CAACf,QAAO,IAAKe,KAAK,CAACd,SAAQ,IAChCc,KAAK,CAACb,QAAQ;MAC7C,IAAI,CAACZ,aAAa,CAAC;IACrB;EACF,CAAC;EACD2B,OAAO,EAAE;IACP;IACAC,oBAAoBA,CAAA,EAAG;MACrB,IAAI,CAACZ,qBAAoB,GAAI,CAAC,IAAI,CAACA,qBAAoB;IACzD,CAAC;IAED;IACA,MAAMhB,aAAaA,CAAA,EAAG;MACpB,IAAI,CAACiB,eAAc,GAAI,IAAG;MAC1B,IAAI;QACFY,OAAO,CAACC,GAAG,CAAC,OAAO,EAAE,IAAI,CAACxB,YAAY;QACtC,MAAMyB,QAAO,GAAI,MAAM/B,aAAa,CAAC,IAAI,CAACM,YAAY;QACtDuB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEC,QAAQ;;QAE7B;QACA;QACA,IAAIA,QAAQ,CAAC1B,IAAG,IAAK0B,QAAQ,CAAC1B,IAAI,CAAC2B,IAAG,KAAM,GAAE,IAAKD,QAAQ,CAAC1B,IAAI,CAACA,IAAI,EAAE;UACrEwB,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEC,QAAQ,CAAC1B,IAAI,CAACA,IAAI,CAAC4B,OAAO;UACtD,IAAI,CAACpB,OAAM,GAAIkB,QAAQ,CAAC1B,IAAI,CAACA,IAAI,CAAC4B,OAAM,IAAK,EAAC;UAC9C,IAAI,CAACnB,cAAa,GAAI,EAAC,EAAE;UACzBe,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAACjB,OAAO;QAChD,OAAO;UACLgB,OAAO,CAACK,KAAK,CAAC,gBAAgB,EAAEH,QAAQ,CAAC1B,IAAI;UAC7C,IAAI,CAACQ,OAAM,GAAI,EAAC;UAChB,IAAI,CAACC,cAAa,GAAI,EAAC;QACzB;;QAEA;QACA,IAAI,CAACqB,eAAe,CAAC;MACvB,EAAE,OAAOD,KAAK,EAAE;QACdL,OAAO,CAACK,KAAK,CAAC,SAAS,EAAEA,KAAK;QAC9B,IAAI,CAACrB,OAAM,GAAI,EAAC;QAChB,IAAI,CAACC,cAAa,GAAI,EAAC;MACzB;IACF,CAAC;IAED;IACA,MAAMU,iBAAiBA,CAAA,EAAG;MACxB,IAAI;QACF,MAAMO,QAAO,GAAI,MAAM9B,aAAa,CAAC;QACrC;QACA,IAAI8B,QAAQ,CAAC1B,IAAG,IAAK0B,QAAQ,CAAC1B,IAAI,CAAC2B,IAAG,KAAM,GAAE,IAAKD,QAAQ,CAAC1B,IAAI,CAACA,IAAI,EAAE;UACrE,IAAI,CAACU,aAAY,GAAIgB,QAAQ,CAAC1B,IAAI,CAACA,IAAI,CAAC+B,KAAK,CAAC,CAAC,EAAE,CAAC,GAAE;QACtD,OAAO;UACLP,OAAO,CAACK,KAAK,CAAC,kBAAkB,EAAEH,QAAQ,CAAC1B,IAAI;UAC/C,IAAI,CAACU,aAAY,GAAI,EAAC;QACxB;MACF,EAAE,OAAOmB,KAAK,EAAE;QACdL,OAAO,CAACK,KAAK,CAAC,WAAW,EAAEA,KAAK;QAChC,IAAI,CAACnB,aAAY,GAAI,EAAC;MACxB;IACF,CAAC;IAED;IACAsB,gBAAgBA,CAAClB,EAAE,EAAE;MACnB,IAAI,CAACmB,OAAO,CAACC,IAAI,CAAC,WAAWpB,EAAE,EAAE;IACnC,CAAC;IAED;IACAqB,UAAUA,CAACrB,EAAE,EAAE;MACb,IAAI,CAACmB,OAAO,CAACC,IAAI,CAAC,gBAAgBpB,EAAE,EAAE;IACxC,CAAC;IAED;IACAsB,aAAaA,CAACtB,EAAE,EAAEf,IAAI,EAAE;MACtB,IAAI,CAACc,cAAa,GAAI;QACpBC,EAAE;QACFf;MACF;MACA,IAAI,CAACgB,WAAW,CAACsB,IAAI,CAAC;IACxB,CAAC;IAED;IACA,MAAMxC,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,MAAMA,YAAY,CAAC,IAAI,CAACgB,cAAc,CAACC,EAAE;QACzC;QACA,IAAI,CAACN,OAAM,GAAI,IAAI,CAACA,OAAO,CAAC8B,MAAM,CAACC,MAAK,IAAKA,MAAM,CAACzB,EAAC,KAAM,IAAI,CAACD,cAAc,CAACC,EAAE;QACjF,IAAI,CAACL,cAAa,GAAI,IAAI,CAACA,cAAc,CAAC6B,MAAM,CAACC,MAAK,IAAKA,MAAM,CAACzB,EAAC,KAAM,IAAI,CAACD,cAAc,CAACC,EAAE;QAC/F,IAAI,CAACJ,aAAY,GAAI,IAAI,CAACA,aAAa,CAAC4B,MAAM,CAACC,MAAK,IAAKA,MAAM,CAACzB,EAAC,KAAM,IAAI,CAACD,cAAc,CAACC,EAAE;;QAE7F;QACA,IAAI,CAACC,WAAW,CAACyB,IAAI,CAAC;;QAEtB;QACA,IAAI,CAACC,QAAQ,CAACC,KAAK,CAAC,QAAQ,EAAE;UAC5BC,KAAK,EAAE,MAAM;UACbC,OAAO,EAAE,SAAS;UAClBC,KAAK,EAAE;QACT,CAAC;MACH,EAAE,OAAOhB,KAAK,EAAE;QACdL,OAAO,CAACK,KAAK,CAAC,SAAS,EAAEA,KAAK;QAC9B,IAAI,CAACY,QAAQ,CAACC,KAAK,CAAC,SAASb,KAAK,CAACiB,OAAM,IAAK,MAAM,EAAE,EAAE;UACtDH,KAAK,EAAE,MAAM;UACbC,OAAO,EAAE,QAAQ;UACjBC,KAAK,EAAE;QACT,CAAC;MACH;IACF,CAAC;IAED;IACAf,eAAeA,CAAA,EAAG;MAChB,MAAMV,KAAI,GAAI,CAAC;MACf,IAAI,IAAI,CAACnB,YAAY,CAACC,CAAC,EAAEkB,KAAK,CAAClB,CAAA,GAAI,IAAI,CAACD,YAAY,CAACC,CAAA;MACrD,IAAI,IAAI,CAACD,YAAY,CAACE,UAAU,EAAEiB,KAAK,CAACjB,UAAS,GAAI,IAAI,CAACF,YAAY,CAACE,UAAS;MAChF,IAAI,IAAI,CAACF,YAAY,CAACG,QAAQ,EAAEgB,KAAK,CAAChB,QAAO,GAAI,IAAI,CAACH,YAAY,CAACG,QAAO;MAC1E,IAAI,IAAI,CAACH,YAAY,CAACI,QAAQ,EAAEe,KAAK,CAACf,QAAO,GAAI,IAAI,CAACJ,YAAY,CAACI,QAAO;MAC1E,IAAI,IAAI,CAACJ,YAAY,CAACK,SAAS,EAAEc,KAAK,CAACd,SAAQ,GAAI,IAAI,CAACL,YAAY,CAACK,SAAQ;MAC7E,IAAI,IAAI,CAACL,YAAY,CAACM,QAAQ,EAAEa,KAAK,CAACb,QAAO,GAAI,IAAI,CAACN,YAAY,CAACM,QAAO;MAE1E,IAAI,CAAC0B,OAAO,CAACc,OAAO,CAAC;QAAE3B;MAAM,CAAC;IAChC,CAAC;IAED;IACA4B,UAAUA,CAACC,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,EAAC;MACzB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;MAChC,OAAOC,IAAI,CAACE,kBAAkB,CAAC,OAAO,EAAE;QAAEC,IAAI,EAAE,SAAS;QAAEC,KAAK,EAAE,SAAS;QAAEC,GAAG,EAAE;MAAU,CAAC;IAC/F,CAAC;IAED;IACAC,UAAUA,CAACP,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,EAAC;MACzB,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU;MAChC,OAAOC,IAAI,CAACO,kBAAkB,CAAC,OAAO,EAAE;QAAEC,IAAI,EAAE,SAAS;QAAEC,MAAM,EAAE;MAAU,CAAC;IAChF,CAAC;IAED;IACAC,YAAYA,CAACC,IAAI,EAAEC,MAAM,EAAE;MACzB,IAAI,CAACD,IAAI,EAAE,OAAO,EAAC;MACnB,OAAOA,IAAI,CAACC,MAAK,GAAIA,MAAK,GAAID,IAAI,CAACE,SAAS,CAAC,CAAC,EAAED,MAAM,IAAI,KAAI,GAAID,IAAG;IACvE,CAAC;IAED;IACAG,aAAaA,CAACH,IAAI,EAAE;MAClB,IAAI,CAACA,IAAG,IAAK,CAAC,IAAI,CAAC5D,YAAY,CAACC,CAAC,EAAE,OAAO2D,IAAG;MAC7C,MAAMI,KAAI,GAAI,IAAIC,MAAM,CAAC,IAAI,CAACjE,YAAY,CAACC,CAAC,EAAE,IAAI;MAClD,OAAO2D,IAAI,CAACd,OAAO,CAACkB,KAAK,EAAEE,KAAI,IAAK,2BAA2BA,KAAK,SAAS;IAC/E;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}