{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { ref, reactive, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { Modal } from 'bootstrap';\nimport { getRecordList, searchRecords, deleteRecord as apiDeleteRecord } from '@/api/record';\nexport default {\n  name: 'RecordSearch',\n  setup() {\n    const router = useRouter();\n    const records = ref([]);\n    const recentRecords = ref([]);\n    const searchPerformed = ref(false);\n    const viewMode = ref('card');\n    const showAdvancedSearch = ref(false);\n    const recordToDelete = ref(null);\n    let deleteModal = null;\n    const searchParams = reactive({\n      keyword: '',\n      caseName: '',\n      assistantName: '',\n      inquirerName: '',\n      inquiryId: '',\n      inquiryAddress: '',\n      startDate: '',\n      endDate: ''\n    });\n\n    // 模拟数据，后续将替换为API调用\n    const mockRecords = [{\n      id: 1,\n      recordName: '张三询问笔录',\n      caseName: '2023年盗窃案',\n      inquiryAddress: '北京市公安局海淀分局',\n      assistantName: '李警官',\n      inquirerName: '张三',\n      inquiryId: '110101199003071234',\n      textContent: '问：请问你的姓名？答：张三。问：你是否清楚本次询问的内容？答：是的，关于昨天晚上发生在小区的盗窃案。问：请你描述一下案发经过。答：昨天晚上大约11点，我听到楼道有异响，打开门后发现一名陌生男子正在撬对门王先生家的门锁...',\n      createdAt: '2023-08-15T10:30:00'\n    }, {\n      id: 2,\n      recordName: '李四询问笔录',\n      caseName: '2023年诈骗案',\n      inquiryAddress: '北京市公安局朝阳分局',\n      assistantName: '王警官',\n      inquirerName: '李四',\n      inquiryId: '110101199107084321',\n      textContent: '问：请问你的姓名？答：李四。问：你是否清楚本次询问的内容？答：是的，关于我遭遇的电信诈骗。问：请你描述一下案发经过。答：上周三下午，我接到一个自称是银行工作人员的电话，说我的银行卡有异常交易，需要核实身份信息...',\n      createdAt: '2023-08-10T14:20:00'\n    }, {\n      id: 3,\n      recordName: '王五询问笔录',\n      caseName: '2023年交通事故案',\n      inquiryAddress: '北京市公安局西城分局',\n      assistantName: '赵警官',\n      inquirerName: '王五',\n      inquiryId: '110101199505057890',\n      textContent: '问：请问你的姓名？答：王五。问：你是否清楚本次询问的内容？答：是的，关于昨天下午在西直门交叉路口发生的交通事故。问：请你描述一下事故发生的经过。答：当时我驾驶一辆蓝色轿车沿着西直门外大街由东向西行驶，当行驶到西直门交叉路口时...',\n      createdAt: '2023-07-05T16:45:00'\n    }];\n\n    // 初始化\n    onMounted(() => {\n      // 获取最近笔录\n      fetchRecentRecords();\n\n      // 初始化删除模态框\n      deleteModal = new Modal(document.getElementById('deleteConfirmModal'));\n    });\n\n    // 获取最近笔录\n    const fetchRecentRecords = async () => {\n      try {\n        const response = await getRecordList();\n        if (response.data && response.data.code === 200) {\n          recentRecords.value = response.data.data.slice(0, 6); // 显示最近6条记录\n        } else {\n          console.error('获取笔录列表失败:', response.data?.message || '未知错误');\n          // 如果API调用失败，使用模拟数据作为备选\n          recentRecords.value = [...mockRecords];\n        }\n      } catch (error) {\n        console.error('获取笔录列表失败:', error);\n        // 如果API调用失败，使用模拟数据作为备选\n        recentRecords.value = [...mockRecords];\n      }\n    };\n\n    // 搜索笔录\n    const searchRecords = async () => {\n      try {\n        // 构建搜索参数\n        const params = {\n          page: 1,\n          size: 50,\n          // 获取更多结果\n          q: searchParams.keyword || undefined,\n          startDate: searchParams.startDate || undefined,\n          endDate: searchParams.endDate || undefined,\n          location: searchParams.inquiryAddress || undefined,\n          assistant: searchParams.assistantName || undefined,\n          inquirer: searchParams.inquirerName || undefined\n        };\n\n        // 移除空值参数\n        Object.keys(params).forEach(key => {\n          if (params[key] === undefined || params[key] === '') {\n            delete params[key];\n          }\n        });\n        const response = await searchRecords(params);\n        if (response.data && response.data.code === 200) {\n          records.value = response.data.data.records || [];\n        } else {\n          console.error('搜索笔录失败:', response.data?.message || '未知错误');\n          records.value = [];\n        }\n      } catch (error) {\n        console.error('搜索笔录失败:', error);\n        records.value = [];\n      }\n      searchPerformed.value = true;\n    };\n\n    // 重置搜索\n    const resetSearch = () => {\n      Object.keys(searchParams).forEach(key => {\n        searchParams[key] = '';\n      });\n      searchPerformed.value = false;\n    };\n\n    // 切换高级搜索\n    const toggleAdvancedSearch = () => {\n      showAdvancedSearch.value = !showAdvancedSearch.value;\n    };\n\n    // 查看笔录详情\n    const viewRecordDetail = id => {\n      console.log('查看笔录详情:', id);\n      router.push(`/record/${id}`);\n    };\n\n    // 编辑笔录\n    const editRecord = id => {\n      console.log('编辑笔录:', id);\n      // 暂时跳转到详情页，后续可以添加编辑功能\n      router.push(`/record/${id}`);\n    };\n\n    // 确认删除\n    const confirmDelete = id => {\n      recordToDelete.value = mockRecords.find(record => record.id === id);\n      deleteModal.show();\n    };\n\n    // 删除笔录\n    const deleteRecord = () => {\n      // 实际项目中应该调用API删除笔录\n      console.log('删除笔录:', recordToDelete.value.id);\n\n      // 模拟删除操作\n      const index = mockRecords.findIndex(record => record.id === recordToDelete.value.id);\n      if (index !== -1) {\n        mockRecords.splice(index, 1);\n\n        // 更新列表\n        if (searchPerformed.value) {\n          records.value = records.value.filter(record => record.id !== recordToDelete.value.id);\n        } else {\n          recentRecords.value = recentRecords.value.filter(record => record.id !== recordToDelete.value.id);\n        }\n      }\n\n      // 关闭模态框\n      deleteModal.hide();\n    };\n\n    // 格式化日期时间\n    const formatDateTime = dateString => {\n      const date = new Date(dateString);\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    };\n\n    // 格式化日期\n    const formatDate = dateString => {\n      const date = new Date(dateString);\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      });\n    };\n    return {\n      records,\n      recentRecords,\n      searchParams,\n      searchPerformed,\n      viewMode,\n      showAdvancedSearch,\n      recordToDelete,\n      searchRecords,\n      resetSearch,\n      toggleAdvancedSearch,\n      viewRecordDetail,\n      editRecord,\n      confirmDelete,\n      deleteRecord,\n      formatDateTime,\n      formatDate\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","useRouter","Modal","getRecordList","searchRecords","deleteRecord","apiDeleteRecord","name","setup","router","records","recentRecords","searchPerformed","viewMode","showAdvancedSearch","recordToDelete","deleteModal","searchParams","keyword","caseName","assistantName","inquirerName","inquiryId","inquiryAddress","startDate","endDate","mockRecords","id","recordName","textContent","createdAt","fetchRecentRecords","document","getElementById","response","data","code","value","slice","console","error","message","params","page","size","q","undefined","location","assistant","inquirer","Object","keys","forEach","key","resetSearch","toggleAdvancedSearch","viewRecordDetail","log","push","editRecord","confirmDelete","find","record","show","index","findIndex","splice","filter","hide","formatDateTime","dateString","date","Date","toLocaleString","year","month","day","hour","minute","formatDate","toLocaleDateString"],"sources":["/Users/sunziang/IdeaProjects/backend_bilu/bilu_backend2/src/components/record/RecordSearch.vue"],"sourcesContent":["<template>\n  <div class=\"record-search-container\">\n    <!-- 页面标题区域 -->\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n      <h2 class=\"mb-0\">\n        <i class=\"bi bi-search me-2\"></i> 笔录搜索\n      </h2>\n    </div>\n\n    <!-- 搜索表单 -->\n    <div class=\"card shadow-sm mb-4\">\n      <div class=\"card-body\">\n        <form @submit.prevent=\"searchRecords\">\n          <div class=\"row g-3\">\n            <div class=\"col-md-6\">\n              <div class=\"input-group\">\n                <span class=\"input-group-text bg-light\">\n                  <i class=\"bi bi-search text-primary\"></i>\n                </span>\n                <input \n                  type=\"text\" \n                  class=\"form-control\" \n                  v-model=\"searchParams.keyword\" \n                  placeholder=\"搜索关键词（笔录内容、案件名称、询问人等）\"\n                >\n                <button type=\"submit\" class=\"btn btn-primary px-4\">\n                  <i class=\"bi bi-search me-1\"></i> 搜索\n                </button>\n              </div>\n            </div>\n            <div class=\"col-md-6 text-end\">\n              <button \n                type=\"button\" \n                class=\"btn btn-outline-secondary\" \n                @click=\"toggleAdvancedSearch\"\n              >\n                <i class=\"bi\" :class=\"showAdvancedSearch ? 'bi-chevron-up' : 'bi-chevron-down'\"></i>\n                {{ showAdvancedSearch ? '收起高级搜索' : '展开高级搜索' }}\n              </button>\n            </div>\n          </div>\n\n          <!-- 高级搜索选项 -->\n          <div v-if=\"showAdvancedSearch\" class=\"row g-3 mt-2\">\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">案件名称</label>\n              <input \n                type=\"text\" \n                class=\"form-control\" \n                v-model=\"searchParams.caseName\" \n                placeholder=\"输入案件名称\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">询问员</label>\n              <input \n                type=\"text\" \n                class=\"form-control\" \n                v-model=\"searchParams.assistantName\" \n                placeholder=\"输入询问员姓名\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">被询问人</label>\n              <input \n                type=\"text\" \n                class=\"form-control\" \n                v-model=\"searchParams.inquirerName\" \n                placeholder=\"输入被询问人姓名\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">身份证号</label>\n              <input \n                type=\"text\" \n                class=\"form-control\" \n                v-model=\"searchParams.inquiryId\" \n                placeholder=\"输入身份证号\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">询问地点</label>\n              <input \n                type=\"text\" \n                class=\"form-control\" \n                v-model=\"searchParams.inquiryAddress\" \n                placeholder=\"输入询问地点\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">开始日期</label>\n              <input \n                type=\"date\" \n                class=\"form-control\" \n                v-model=\"searchParams.startDate\"\n              >\n            </div>\n            <div class=\"col-md-3\">\n              <label class=\"form-label\">结束日期</label>\n              <input \n                type=\"date\" \n                class=\"form-control\" \n                v-model=\"searchParams.endDate\"\n              >\n            </div>\n            <div class=\"col-md-3 d-flex align-items-end\">\n              <button type=\"button\" class=\"btn btn-outline-secondary w-100\" @click=\"resetSearch\">\n                <i class=\"bi bi-arrow-counterclockwise me-1\"></i> 重置筛选\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- 搜索结果 -->\n    <div v-if=\"searchPerformed\">\n      <div class=\"d-flex justify-content-between align-items-center mb-3\">\n        <h5 class=\"mb-0\">\n          <i class=\"bi bi-list-ul me-2\"></i> 搜索结果\n          <span class=\"badge bg-primary ms-2\">{{ records.length }}</span>\n        </h5>\n        <div>\n          <button \n            type=\"button\" \n            class=\"btn btn-sm btn-outline-secondary me-2\" \n            :class=\"{ 'active': viewMode === 'card' }\" \n            @click=\"viewMode = 'card'\"\n          >\n            <i class=\"bi bi-grid\"></i>\n          </button>\n          <button \n            type=\"button\" \n            class=\"btn btn-sm btn-outline-secondary\" \n            :class=\"{ 'active': viewMode === 'list' }\" \n            @click=\"viewMode = 'list'\"\n          >\n            <i class=\"bi bi-list\"></i>\n          </button>\n        </div>\n      </div>\n\n      <!-- 卡片视图 -->\n      <div v-if=\"viewMode === 'card' && records.length > 0\" class=\"row g-3\">\n        <div v-for=\"record in records\" :key=\"record.id\" class=\"col-md-6 col-lg-4\">\n          <div class=\"card h-100 shadow-sm hover-card\">\n            <div class=\"card-header bg-gradient-primary text-white d-flex justify-content-between align-items-center\">\n              <h6 class=\"mb-0 text-truncate\" style=\"max-width: 80%;\">{{ record.recordName }}</h6>\n              <div class=\"dropdown\">\n                <button class=\"btn btn-sm btn-icon btn-light rounded-circle\" type=\"button\" data-bs-toggle=\"dropdown\">\n                  <i class=\"bi bi-three-dots-vertical\"></i>\n                </button>\n                <ul class=\"dropdown-menu dropdown-menu-end\">\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"viewRecordDetail(record.id)\">\n                      <i class=\"bi bi-eye me-2 text-primary\"></i> 查看详情\n                    </a>\n                  </li>\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"editRecord(record.id)\">\n                      <i class=\"bi bi-pencil me-2 text-warning\"></i> 修改\n                    </a>\n                  </li>\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"confirmDelete(record.id)\">\n                      <i class=\"bi bi-trash me-2 text-danger\"></i> 删除\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n            <div class=\"card-body\">\n              <div class=\"mb-3\">\n                <div class=\"d-flex mb-2\">\n                  <div class=\"flex-shrink-0 me-2\">\n                    <i class=\"bi bi-folder text-primary\"></i>\n                  </div>\n                  <div class=\"flex-grow-1\">\n                    <div class=\"small text-muted\">案件名称</div>\n                    <div class=\"fw-medium\">{{ record.caseName || '未关联案件' }}</div>\n                  </div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"flex-shrink-0 me-2\">\n                    <i class=\"bi bi-geo-alt text-primary\"></i>\n                  </div>\n                  <div class=\"flex-grow-1\">\n                    <div class=\"small text-muted\">询问地点</div>\n                    <div class=\"fw-medium\">{{ record.inquiryAddress }}</div>\n                  </div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"flex-shrink-0 me-2\">\n                    <i class=\"bi bi-person text-primary\"></i>\n                  </div>\n                  <div class=\"flex-grow-1\">\n                    <div class=\"small text-muted\">询问员</div>\n                    <div class=\"fw-medium\">{{ record.assistantName }}</div>\n                  </div>\n                </div>\n                <div class=\"d-flex mb-2\">\n                  <div class=\"flex-shrink-0 me-2\">\n                    <i class=\"bi bi-person-circle text-primary\"></i>\n                  </div>\n                  <div class=\"flex-grow-1\">\n                    <div class=\"small text-muted\">被询问人</div>\n                    <div class=\"fw-medium\">{{ record.inquirerName }}</div>\n                  </div>\n                </div>\n                <div class=\"d-flex\">\n                  <div class=\"flex-shrink-0 me-2\">\n                    <i class=\"bi bi-credit-card text-primary\"></i>\n                  </div>\n                  <div class=\"flex-grow-1\">\n                    <div class=\"small text-muted\">身份证号</div>\n                    <div class=\"fw-medium\">{{ record.inquiryId }}</div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"content-preview p-2 bg-light rounded\">\n                <div class=\"small text-muted mb-1\">内容预览：</div>\n                <div class=\"small text-truncate-3\">{{ record.textContent }}</div>\n              </div>\n            </div>\n            <div class=\"card-footer bg-light d-flex justify-content-between align-items-center\">\n              <small class=\"text-muted\">\n                <i class=\"bi bi-clock me-1\"></i> {{ formatDateTime(record.createdAt) }}\n              </small>\n              <button class=\"btn btn-sm btn-primary\" @click=\"viewRecordDetail(record.id)\">\n                <i class=\"bi bi-eye me-1\"></i> 查看详情\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 列表视图 -->\n      <div v-else-if=\"viewMode === 'list' && records.length > 0\" class=\"card shadow-sm\">\n        <div class=\"table-responsive\">\n          <table class=\"table table-hover align-middle mb-0\">\n            <thead class=\"bg-light\">\n              <tr>\n                <th>笔录名称</th>\n                <th>案件名称</th>\n                <th>询问地点</th>\n                <th>询问员</th>\n                <th>被询问人</th>\n                <th>身份证号</th>\n                <th>创建时间</th>\n                <th class=\"text-end\">操作</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"record in records\" :key=\"record.id\">\n                <td class=\"fw-medium\">{{ record.recordName }}</td>\n                <td>{{ record.caseName || '未关联案件' }}</td>\n                <td>{{ record.inquiryAddress }}</td>\n                <td>{{ record.assistantName }}</td>\n                <td>{{ record.inquirerName }}</td>\n                <td>{{ record.inquiryId }}</td>\n                <td>{{ formatDateTime(record.createdAt) }}</td>\n                <td>\n                  <div class=\"btn-group float-end\">\n                    <button \n                      type=\"button\" \n                      class=\"btn btn-sm btn-outline-primary\" \n                      @click=\"viewRecordDetail(record.id)\"\n                    >\n                      <i class=\"bi bi-eye\"></i> 查看\n                    </button>\n                    <button \n                      type=\"button\" \n                      class=\"btn btn-sm btn-outline-warning\" \n                      @click=\"editRecord(record.id)\"\n                    >\n                      <i class=\"bi bi-pencil\"></i> 编辑\n                    </button>\n                    <button \n                      type=\"button\" \n                      class=\"btn btn-sm btn-outline-danger\" \n                      @click=\"confirmDelete(record.id)\"\n                    >\n                      <i class=\"bi bi-trash\"></i> 删除\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- 无搜索结果 -->\n      <div v-else-if=\"records.length === 0\" class=\"card shadow-sm\">\n        <div class=\"card-body text-center py-5\">\n          <div class=\"mb-3\">\n            <i class=\"bi bi-search text-muted\" style=\"font-size: 3rem;\"></i>\n          </div>\n          <h5>未找到匹配的笔录</h5>\n          <p class=\"text-muted\">尝试使用不同的关键词或筛选条件</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- 未搜索时显示最近笔录 -->\n    <div v-else>\n      <div class=\"d-flex justify-content-between align-items-center mb-3\">\n        <h5 class=\"mb-0\">\n          <i class=\"bi bi-clock-history me-2\"></i> 最近笔录\n        </h5>\n      </div>\n\n      <!-- 时间线视图 -->\n      <div class=\"timeline-container\">\n        <div v-if=\"recentRecords.length > 0\" class=\"timeline\">\n          <div v-for=\"record in recentRecords\" :key=\"record.id\" class=\"timeline-item\">\n            <div class=\"timeline-point\"></div>\n            <div class=\"timeline-content card shadow-sm\">\n              <div class=\"card-body\">\n                <div class=\"d-flex justify-content-between align-items-center mb-3\">\n                  <h6 class=\"mb-0\">{{ record.recordName }}</h6>\n                  <span class=\"badge bg-primary\">{{ formatDate(record.createdAt) }}</span>\n                </div>\n                <div class=\"row g-3 mb-3\">\n                  <div class=\"col-md-6\">\n                    <div class=\"d-flex\">\n                      <div class=\"flex-shrink-0 me-2\">\n                        <i class=\"bi bi-folder text-primary\"></i>\n                      </div>\n                      <div class=\"flex-grow-1\">\n                        <div class=\"small text-muted\">案件名称</div>\n                        <div>{{ record.caseName || '未关联案件' }}</div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"col-md-6\">\n                    <div class=\"d-flex\">\n                      <div class=\"flex-shrink-0 me-2\">\n                        <i class=\"bi bi-geo-alt text-primary\"></i>\n                      </div>\n                      <div class=\"flex-grow-1\">\n                        <div class=\"small text-muted\">询问地点</div>\n                        <div>{{ record.inquiryAddress }}</div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"col-md-6\">\n                    <div class=\"d-flex\">\n                      <div class=\"flex-shrink-0 me-2\">\n                        <i class=\"bi bi-person text-primary\"></i>\n                      </div>\n                      <div class=\"flex-grow-1\">\n                        <div class=\"small text-muted\">询问员</div>\n                        <div>{{ record.assistantName }}</div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"col-md-6\">\n                    <div class=\"d-flex\">\n                      <div class=\"flex-shrink-0 me-2\">\n                        <i class=\"bi bi-person-circle text-primary\"></i>\n                      </div>\n                      <div class=\"flex-grow-1\">\n                        <div class=\"small text-muted\">被询问人</div>\n                        <div>{{ record.inquirerName }}</div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"d-flex justify-content-end\">\n                  <button \n                    type=\"button\" \n                    class=\"btn btn-sm btn-outline-primary me-2\" \n                    @click=\"viewRecordDetail(record.id)\"\n                  >\n                    <i class=\"bi bi-eye me-1\"></i> 查看详情\n                  </button>\n                  <button \n                    type=\"button\" \n                    class=\"btn btn-sm btn-outline-warning me-2\" \n                    @click=\"editRecord(record.id)\"\n                  >\n                    <i class=\"bi bi-pencil me-1\"></i> 修改\n                  </button>\n                  <button \n                    type=\"button\" \n                    class=\"btn btn-sm btn-outline-danger\" \n                    @click=\"confirmDelete(record.id)\"\n                  >\n                    <i class=\"bi bi-trash me-1\"></i> 删除\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- 无最近笔录 -->\n        <div v-else class=\"card shadow-sm\">\n          <div class=\"card-body text-center py-5\">\n            <div class=\"mb-3\">\n              <i class=\"bi bi-clock-history text-muted\" style=\"font-size: 3rem;\"></i>\n            </div>\n            <h5>暂无笔录记录</h5>\n            <p class=\"text-muted\">您可以使用搜索功能查找笔录</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 删除确认模态框 -->\n    <div class=\"modal fade\" id=\"deleteConfirmModal\" tabindex=\"-1\" aria-hidden=\"true\">\n      <div class=\"modal-dialog modal-dialog-centered\">\n        <div class=\"modal-content border-0 shadow rounded-4 overflow-hidden\">\n          <div class=\"modal-header bg-danger text-white\">\n            <h5 class=\"modal-title fw-bold\">\n              <i class=\"bi bi-exclamation-triangle-fill me-2\"></i>确认删除\n            </h5>\n            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n          </div>\n          <div class=\"modal-body py-4\">\n            <div class=\"d-flex align-items-center mb-3\">\n              <div class=\"bg-danger bg-opacity-10 p-3 rounded-circle me-3\">\n                <i class=\"bi bi-trash text-danger fs-3\"></i>\n              </div>\n              <div>\n                <h5>您确定要删除此笔录吗？</h5>\n                <p class=\"fw-bold fs-5 mb-0\" id=\"recordNameToDelete\">{{ recordToDelete?.recordName }}</p>\n              </div>\n            </div>\n            <div class=\"alert alert-warning border-0 shadow-sm\">\n              <i class=\"bi bi-info-circle-fill me-2\"></i>\n              <strong>警告：</strong>此操作不可逆，删除后数据将无法恢复！\n            </div>\n          </div>\n          <div class=\"modal-footer border-top-0\">\n            <button type=\"button\" class=\"btn btn-light rounded-pill px-4\" data-bs-dismiss=\"modal\">\n              <i class=\"bi bi-x-circle me-1\"></i>取消\n            </button>\n            <button type=\"button\" class=\"btn btn-danger rounded-pill px-4 shadow-sm\" @click=\"deleteRecord\">\n              <i class=\"bi bi-trash me-1\"></i>确认删除\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Modal } from 'bootstrap'\nimport { getRecordList, searchRecords, deleteRecord as apiDeleteRecord } from '@/api/record'\n\nexport default {\n  name: 'RecordSearch',\n  setup() {\n    const router = useRouter()\n    const records = ref([])\n    const recentRecords = ref([])\n    const searchPerformed = ref(false)\n    const viewMode = ref('card')\n    const showAdvancedSearch = ref(false)\n    const recordToDelete = ref(null)\n    let deleteModal = null\n\n    const searchParams = reactive({\n      keyword: '',\n      caseName: '',\n      assistantName: '',\n      inquirerName: '',\n      inquiryId: '',\n      inquiryAddress: '',\n      startDate: '',\n      endDate: ''\n    })\n    \n    // 模拟数据，后续将替换为API调用\n    const mockRecords = [\n      {\n        id: 1,\n        recordName: '张三询问笔录',\n        caseName: '2023年盗窃案',\n        inquiryAddress: '北京市公安局海淀分局',\n        assistantName: '李警官',\n        inquirerName: '张三',\n        inquiryId: '110101199003071234',\n        textContent: '问：请问你的姓名？答：张三。问：你是否清楚本次询问的内容？答：是的，关于昨天晚上发生在小区的盗窃案。问：请你描述一下案发经过。答：昨天晚上大约11点，我听到楼道有异响，打开门后发现一名陌生男子正在撬对门王先生家的门锁...',\n        createdAt: '2023-08-15T10:30:00'\n      },\n      {\n        id: 2,\n        recordName: '李四询问笔录',\n        caseName: '2023年诈骗案',\n        inquiryAddress: '北京市公安局朝阳分局',\n        assistantName: '王警官',\n        inquirerName: '李四',\n        inquiryId: '110101199107084321',\n        textContent: '问：请问你的姓名？答：李四。问：你是否清楚本次询问的内容？答：是的，关于我遭遇的电信诈骗。问：请你描述一下案发经过。答：上周三下午，我接到一个自称是银行工作人员的电话，说我的银行卡有异常交易，需要核实身份信息...',\n        createdAt: '2023-08-10T14:20:00'\n      },\n      {\n        id: 3,\n        recordName: '王五询问笔录',\n        caseName: '2023年交通事故案',\n        inquiryAddress: '北京市公安局西城分局',\n        assistantName: '赵警官',\n        inquirerName: '王五',\n        inquiryId: '110101199505057890',\n        textContent: '问：请问你的姓名？答：王五。问：你是否清楚本次询问的内容？答：是的，关于昨天下午在西直门交叉路口发生的交通事故。问：请你描述一下事故发生的经过。答：当时我驾驶一辆蓝色轿车沿着西直门外大街由东向西行驶，当行驶到西直门交叉路口时...',\n        createdAt: '2023-07-05T16:45:00'\n      }\n    ]\n\n    // 初始化\n    onMounted(() => {\n      // 获取最近笔录\n      fetchRecentRecords()\n      \n      // 初始化删除模态框\n      deleteModal = new Modal(document.getElementById('deleteConfirmModal'))\n    })\n\n    // 获取最近笔录\n    const fetchRecentRecords = async () => {\n      try {\n        const response = await getRecordList()\n        if (response.data && response.data.code === 200) {\n          recentRecords.value = response.data.data.slice(0, 6) // 显示最近6条记录\n        } else {\n          console.error('获取笔录列表失败:', response.data?.message || '未知错误')\n          // 如果API调用失败，使用模拟数据作为备选\n          recentRecords.value = [...mockRecords]\n        }\n      } catch (error) {\n        console.error('获取笔录列表失败:', error)\n        // 如果API调用失败，使用模拟数据作为备选\n        recentRecords.value = [...mockRecords]\n      }\n    }\n\n    // 搜索笔录\n    const searchRecords = async () => {\n      try {\n        // 构建搜索参数\n        const params = {\n          page: 1,\n          size: 50, // 获取更多结果\n          q: searchParams.keyword || undefined,\n          startDate: searchParams.startDate || undefined,\n          endDate: searchParams.endDate || undefined,\n          location: searchParams.inquiryAddress || undefined,\n          assistant: searchParams.assistantName || undefined,\n          inquirer: searchParams.inquirerName || undefined\n        }\n        \n        // 移除空值参数\n        Object.keys(params).forEach(key => {\n          if (params[key] === undefined || params[key] === '') {\n            delete params[key]\n          }\n        })\n        \n        const response = await searchRecords(params)\n        if (response.data && response.data.code === 200) {\n          records.value = response.data.data.records || []\n        } else {\n          console.error('搜索笔录失败:', response.data?.message || '未知错误')\n          records.value = []\n        }\n      } catch (error) {\n        console.error('搜索笔录失败:', error)\n        records.value = []\n      }\n      \n      searchPerformed.value = true\n    }\n\n    // 重置搜索\n    const resetSearch = () => {\n      Object.keys(searchParams).forEach(key => {\n        searchParams[key] = ''\n      })\n      searchPerformed.value = false\n    }\n\n    // 切换高级搜索\n    const toggleAdvancedSearch = () => {\n      showAdvancedSearch.value = !showAdvancedSearch.value\n    }\n\n    // 查看笔录详情\n    const viewRecordDetail = (id) => {\n      console.log('查看笔录详情:', id)\n      router.push(`/record/${id}`)\n    }\n\n    // 编辑笔录\n    const editRecord = (id) => {\n      console.log('编辑笔录:', id)\n      // 暂时跳转到详情页，后续可以添加编辑功能\n      router.push(`/record/${id}`)\n    }\n\n    // 确认删除\n    const confirmDelete = (id) => {\n      recordToDelete.value = mockRecords.find(record => record.id === id)\n      deleteModal.show()\n    }\n\n    // 删除笔录\n    const deleteRecord = () => {\n      // 实际项目中应该调用API删除笔录\n      console.log('删除笔录:', recordToDelete.value.id)\n      \n      // 模拟删除操作\n      const index = mockRecords.findIndex(record => record.id === recordToDelete.value.id)\n      if (index !== -1) {\n        mockRecords.splice(index, 1)\n        \n        // 更新列表\n        if (searchPerformed.value) {\n          records.value = records.value.filter(record => record.id !== recordToDelete.value.id)\n        } else {\n          recentRecords.value = recentRecords.value.filter(record => record.id !== recordToDelete.value.id)\n        }\n      }\n      \n      // 关闭模态框\n      deleteModal.hide()\n    }\n\n    // 格式化日期时间\n    const formatDateTime = (dateString) => {\n      const date = new Date(dateString)\n      return date.toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      })\n    }\n\n    // 格式化日期\n    const formatDate = (dateString) => {\n      const date = new Date(dateString)\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      })\n    }\n\n    return {\n      records,\n      recentRecords,\n      searchParams,\n      searchPerformed,\n      viewMode,\n      showAdvancedSearch,\n      recordToDelete,\n      searchRecords,\n      resetSearch,\n      toggleAdvancedSearch,\n      viewRecordDetail,\n      editRecord,\n      confirmDelete,\n      deleteRecord,\n      formatDateTime,\n      formatDate\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 卡片悬停效果 */\n.hover-card {\n  transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.hover-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1) !important;\n}\n\n/* 卡片头部渐变 */\n.bg-gradient-primary {\n  background: linear-gradient(135deg, #4a6cf7, #2651f0);\n}\n\n/* 内容预览 */\n.content-preview {\n  max-height: 80px;\n  overflow: hidden;\n}\n\n.text-truncate-3 {\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* 时间线样式 */\n.timeline-container {\n  position: relative;\n  padding-left: 30px;\n}\n\n.timeline {\n  position: relative;\n}\n\n.timeline::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  width: 2px;\n  background-color: #e9ecef;\n}\n\n.timeline-item {\n  position: relative;\n  padding-bottom: 30px;\n}\n\n.timeline-point {\n  position: absolute;\n  left: -30px;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background-color: #4a6cf7;\n  border: 2px solid #fff;\n  box-shadow: 0 0 0 2px rgba(74, 108, 247, 0.2);\n  z-index: 1;\n}\n\n.timeline-content {\n  margin-left: 15px;\n}\n\n/* 响应式调整 */\n@media (max-width: 768px) {\n  .timeline-container {\n    padding-left: 20px;\n  }\n  \n  .timeline-point {\n    left: -20px;\n  }\n  \n  .timeline-content {\n    margin-left: 0;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}