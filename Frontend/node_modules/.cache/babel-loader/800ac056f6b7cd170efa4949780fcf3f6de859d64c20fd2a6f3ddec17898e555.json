{"ast":null,"code":"import { ref, reactive, onMounted, watch } from 'vue';\nimport { getCaseList, searchCases, addCase, updateCase, deleteCase as deleteCaseApi, getCaseStatistics } from '@/api/case';\n\n// 导入组件\nimport CaseStatistics from '@/components/case/CaseStatistics.vue';\nimport CaseSearch from '@/components/case/CaseSearch.vue';\nimport CaseList from '@/components/case/CaseList.vue';\nimport Pagination from '@/components/case/Pagination.vue';\nimport AddCaseModal from '@/components/case/modals/AddCaseModal.vue';\nimport EditCaseModal from '@/components/case/modals/EditCaseModal.vue';\nimport DeleteCaseModal from '@/components/case/modals/DeleteCaseModal.vue';\nimport CaseDetailModal from '@/components/case/modals/CaseDetailModal.vue';\nexport default {\n  name: 'CaseManagement',\n  components: {\n    CaseStatistics,\n    CaseSearch,\n    CaseList,\n    Pagination,\n    AddCaseModal,\n    EditCaseModal,\n    DeleteCaseModal,\n    CaseDetailModal\n  },\n  setup() {\n    // 状态变量\n    const loading = ref(false);\n    const statisticsLoading = ref(false);\n    const showAdvancedSearch = ref(false);\n    const cases = ref([]);\n    const statistics = ref({\n      totalCases: 0,\n      criminalCases: 0,\n      civilCases: 0,\n      administrativeCases: 0,\n      investigatingCases: 0,\n      inTrialCases: 0,\n      closedCases: 0\n    });\n\n    // 分页相关\n    const currentPage = ref(1);\n    const pageSize = ref(10);\n    const totalItems = ref(0);\n    const totalPages = ref(0);\n\n    // 搜索表单\n    const searchForm = reactive({\n      keyword: '',\n      caseType: '',\n      status: '',\n      startDateFrom: '',\n      startDateTo: '',\n      createdAtFrom: '',\n      createdAtTo: '',\n      sortBy: 'createdAt_desc',\n      page: 1,\n      size: pageSize.value\n    });\n\n    // 模态框引用\n    const addCaseModalRef = ref(null);\n    const editCaseModalRef = ref(null);\n    const deleteCaseModalRef = ref(null);\n    const caseDetailModalRef = ref(null);\n\n    // 加载案件列表\n    const loadCases = async () => {\n      loading.value = true;\n      try {\n        const response = await getCaseList();\n        if (response.data && response.data.code === 200) {\n          cases.value = response.data.data || [];\n          // 确保totalItems正确设置为案件数量\n          totalItems.value = cases.value.length;\n        } else {\n          console.error('加载案件列表失败:', response.data ? response.data.msg : '未知错误');\n        }\n      } catch (error) {\n        console.error('加载案件列表失败:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 加载案件统计数据\n    const loadStatistics = async () => {\n      statisticsLoading.value = true;\n      try {\n        const response = await getCaseStatistics();\n        if (response.data && response.data.code === 200) {\n          statistics.value = response.data.data || {\n            totalCases: 0,\n            criminalCases: 0,\n            civilCases: 0,\n            administrativeCases: 0,\n            investigatingCases: 0,\n            inTrialCases: 0,\n            closedCases: 0\n          };\n        } else {\n          console.error('加载案件统计失败:', response.data ? response.data.msg : '未知错误');\n        }\n      } catch (error) {\n        console.error('加载案件统计失败:', error);\n      } finally {\n        statisticsLoading.value = false;\n      }\n    };\n\n    // 搜索案件\n    const searchCasesData = async () => {\n      console.log('开始执行searchCasesData方法');\n      loading.value = true;\n      try {\n        // 构建搜索参数\n        const params = {\n          ...searchForm\n        };\n\n        // 确保使用当前的 pageSize 值，并且是数字类型\n        params.size = Number(pageSize.value);\n        params.page = Number(params.page);\n\n        // 将 keyword 参数重命名为 q，以匹配后端 API 期望的参数名\n        if (params.keyword !== undefined) {\n          params.q = params.keyword;\n          delete params.keyword;\n        }\n\n        // 设置默认排序\n        params.sortField = 'createdAt';\n        params.sortOrder = 'desc';\n        delete params.sortBy;\n\n        // 调试：检查参数是否正确\n        console.log('searchForm:', searchForm);\n        console.log('params:', params);\n        console.log('准备发送API请求，参数:', params);\n        const response = await searchCases(params);\n        console.log('API响应:', response);\n        console.log('处理API响应数据:', response);\n        if (response.data) {\n          console.log('响应数据:', response.data);\n          if (response.data.code === 200) {\n            const result = response.data.data;\n            console.log('结果数据:', result);\n            cases.value = result.records || [];\n            // 确保totalItems正确设置为案件数量\n            totalItems.value = result.total !== undefined ? result.total : cases.value.length;\n            totalPages.value = result.pages || 0;\n            currentPage.value = result.current || 1;\n          } else {\n            console.error('搜索案件失败:', response.data.msg || '未知错误');\n          }\n        } else {\n          console.error('搜索案件失败: 响应数据为空');\n        }\n      } catch (error) {\n        console.error('搜索案件失败:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 搜索案件（用于搜索按钮点击事件）\n    const handleSearch = formData => {\n      console.log('CaseManagement收到搜索事件，接收到的数据:', formData);\n      // 将CaseSearch组件传来的keyword字段映射到searchForm的q字段\n      if (formData) {\n        // 检查formData是否包含keyword属性\n        console.log('formData包含keyword属性:', Object.prototype.hasOwnProperty.call(formData, 'keyword'));\n        console.log('formData.keyword值:', formData.keyword);\n\n        // 使用q作为参数名，与后端API保持一致\n        searchForm.q = formData.keyword || '';\n        delete searchForm.keyword; // 删除keyword参数\n\n        searchForm.caseType = formData.caseType || '';\n        searchForm.status = formData.status || '';\n        searchForm.startDateFrom = formData.startDateFrom || '';\n        searchForm.startDateTo = formData.startDateTo || '';\n        searchForm.createdAtFrom = formData.createdAtFrom || '';\n        searchForm.createdAtTo = formData.createdAtTo || '';\n      }\n      console.log('处理后的searchForm:', {\n        ...searchForm\n      });\n      searchForm.page = 1; // 重置到第一页\n      searchCasesData();\n    };\n\n    // 重置搜索\n    const resetSearch = formData => {\n      // 重置搜索表单\n      if (formData) {\n        // 如果CaseSearch组件传来了重置后的表单数据，使用它\n        searchForm.keyword = formData.keyword || '';\n        delete searchForm.q; // 删除旧的q参数\n\n        searchForm.caseType = formData.caseType || '';\n        searchForm.status = formData.status || '';\n        searchForm.startDateFrom = formData.startDateFrom || '';\n        searchForm.startDateTo = formData.startDateTo || '';\n        searchForm.createdAtFrom = formData.createdAtFrom || '';\n        searchForm.createdAtTo = formData.createdAtTo || '';\n      } else {\n        // 否则清空所有搜索条件\n        searchForm.keyword = '';\n        delete searchForm.q; // 删除旧的q参数\n\n        searchForm.caseType = '';\n        searchForm.status = '';\n        searchForm.startDateFrom = '';\n        searchForm.startDateTo = '';\n        searchForm.createdAtFrom = '';\n        searchForm.createdAtTo = '';\n      }\n      // 不再使用这个循环，因为它会清除所有字段，包括我们刚设置的keyword\n      // 而是明确指定需要保留的字段\n      searchForm.page = 1; // 重置到第一页\n      searchCasesData(); // 使用searchCasesData函数执行搜索\n    };\n\n    // 切换高级搜索\n    const toggleAdvancedSearch = value => {\n      // 如果传入了值，使用传入的值；否则切换当前值\n      showAdvancedSearch.value = value !== undefined ? value : !showAdvancedSearch.value;\n    };\n\n    // 切换页码\n    const changePage = page => {\n      searchForm.page = page;\n      searchCasesData();\n    };\n\n    // 更改每页显示数量\n    const changePageSize = size => {\n      if (size) {\n        // 确保 size 是数字类型\n        const numSize = typeof size === 'string' ? parseInt(size) : size;\n        pageSize.value = numSize;\n      }\n\n      // 更新搜索表单中的每页数量\n      searchForm.size = Number(pageSize.value); // 确保是数字类型\n\n      // 重置到第一页\n      searchForm.page = 1;\n\n      // 重新加载数据\n      searchCasesData();\n    };\n\n    // 显示添加案件模态框\n    const showAddCaseModal = () => {\n      if (addCaseModalRef.value) {\n        addCaseModalRef.value.showModal();\n      }\n    };\n\n    // 显示编辑案件模态框\n    const showEditCaseModal = caseItem => {\n      if (editCaseModalRef.value) {\n        editCaseModalRef.value.showModal(caseItem);\n      }\n    };\n\n    // 确认删除案件\n    const confirmDeleteCase = caseItem => {\n      if (deleteCaseModalRef.value) {\n        deleteCaseModalRef.value.showModal(caseItem);\n      }\n    };\n\n    // 查看案件详情\n    const viewCaseDetail = caseId => {\n      if (caseDetailModalRef.value) {\n        caseDetailModalRef.value.showModal(caseId);\n      }\n    };\n\n    // 提交添加案件\n    const submitAddCase = async formData => {\n      try {\n        const response = await addCase(formData);\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData();\n          loadStatistics();\n        } else {\n          console.error('添加案件失败:', response.data ? response.data.msg : '未知错误');\n        }\n      } catch (error) {\n        console.error('添加案件失败:', error);\n      }\n    };\n\n    // 提交编辑案件\n    const submitEditCase = async formData => {\n      try {\n        const response = await updateCase(formData);\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData();\n          loadStatistics();\n        } else {\n          console.error('更新案件失败:', response.data ? response.data.msg : '未知错误');\n        }\n      } catch (error) {\n        console.error('更新案件失败:', error);\n      }\n    };\n\n    // 删除案件\n    const deleteCase = async caseId => {\n      try {\n        const response = await deleteCaseApi(caseId);\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData();\n          loadStatistics();\n        } else {\n          console.error('删除案件失败:', response.data ? response.data.msg : '未知错误');\n        }\n      } catch (error) {\n        console.error('删除案件失败:', error);\n      }\n    };\n\n    // 组件挂载时加载数据\n    onMounted(() => {\n      searchCasesData(); // 使用searchCasesData方法替代loadCases方法\n      loadStatistics();\n    });\n\n    // 监听页码变化\n    watch(currentPage, newPage => {\n      searchForm.page = newPage;\n      searchCasesData(); // 当页码变化时，重新加载数据\n    });\n    return {\n      // 状态\n      loading,\n      statisticsLoading,\n      showAdvancedSearch,\n      cases,\n      statistics,\n      // 分页\n      currentPage,\n      pageSize,\n      totalItems,\n      totalPages,\n      // 表单\n      searchForm,\n      // 模态框引用\n      addCaseModalRef,\n      editCaseModalRef,\n      deleteCaseModalRef,\n      caseDetailModalRef,\n      // 方法\n      toggleAdvancedSearch,\n      searchCases: handleSearch,\n      resetSearch,\n      changePage,\n      changePageSize,\n      showAddCaseModal,\n      showEditCaseModal,\n      confirmDeleteCase,\n      viewCaseDetail,\n      submitAddCase,\n      submitEditCase,\n      deleteCase,\n      loadCases\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","watch","getCaseList","searchCases","addCase","updateCase","deleteCase","deleteCaseApi","getCaseStatistics","CaseStatistics","CaseSearch","CaseList","Pagination","AddCaseModal","EditCaseModal","DeleteCaseModal","CaseDetailModal","name","components","setup","loading","statisticsLoading","showAdvancedSearch","cases","statistics","totalCases","criminalCases","civilCases","administrativeCases","investigatingCases","inTrialCases","closedCases","currentPage","pageSize","totalItems","totalPages","searchForm","keyword","caseType","status","startDateFrom","startDateTo","createdAtFrom","createdAtTo","sortBy","page","size","value","addCaseModalRef","editCaseModalRef","deleteCaseModalRef","caseDetailModalRef","loadCases","response","data","code","length","console","error","msg","loadStatistics","searchCasesData","log","params","Number","undefined","q","sortField","sortOrder","result","records","total","pages","current","handleSearch","formData","Object","prototype","hasOwnProperty","call","resetSearch","toggleAdvancedSearch","changePage","changePageSize","numSize","parseInt","showAddCaseModal","showModal","showEditCaseModal","caseItem","confirmDeleteCase","viewCaseDetail","caseId","submitAddCase","submitEditCase","newPage"],"sources":["/Users/sunziang/IdeaProjects/backend_bilu/bilu_backend2/src/components/case/CaseManagement.vue"],"sourcesContent":["<template>\n  <div class=\"container-fluid mt-4\">\n    <!-- 页面标题区域 -->\n    <div class=\"row mb-4\">\n      <div class=\"col-12\">\n        <div class=\"d-flex justify-content-between align-items-center\">\n          <div>\n            <h2 class=\"display-6 fw-bold text-primary mb-0\">\n              <i class=\"bi bi-folder2-open me-2\"></i>案件管理\n            </h2>\n            <p class=\"text-muted mb-0\">查看和管理所有案件信息</p>\n          </div>\n          <div class=\"btn-group\">\n            <button class=\"btn btn-outline-primary\" @click=\"toggleAdvancedSearch\">\n              <i class=\"bi bi-funnel me-2\"></i>高级搜索\n            </button>\n            <button class=\"btn btn-success\" @click=\"showAddCaseModal\">\n              <i class=\"bi bi-plus-circle me-2\"></i>新增案件\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 案件统计卡片 -->\n    <case-statistics :loading=\"statisticsLoading\" :statistics=\"statistics\" />\n\n    <!-- 搜索区域 -->\n    <case-search \n      :search-form=\"searchForm\" \n      :show-advanced-search=\"showAdvancedSearch\"\n      @toggle-advanced=\"toggleAdvancedSearch\"\n      @search=\"searchCases\"\n      @reset=\"resetSearch\"\n    />\n\n    <!-- 案件列表 -->\n    <case-list \n      :cases=\"cases\" \n      :loading=\"loading\"\n      @view-detail=\"viewCaseDetail\"\n      @add=\"showAddCaseModal\"\n      @edit=\"showEditCaseModal\"\n      @delete=\"confirmDeleteCase\"\n    />\n    \n    <!-- 分页控件 -->\n    <pagination \n      :current-page=\"currentPage\" \n      :total-pages=\"totalPages\" \n      :total-items=\"totalItems\" \n      :page-size=\"pageSize\"\n      @page-change=\"changePage\"\n      @size-change=\"changePageSize\"\n    />\n    \n    <!-- 模态框组件 -->\n    <add-case-modal ref=\"addCaseModalRef\" @submit=\"submitAddCase\" />\n    <edit-case-modal ref=\"editCaseModalRef\" @submit=\"submitEditCase\" />\n    <delete-case-modal ref=\"deleteCaseModalRef\" @confirm=\"deleteCase\" />\n    <case-detail-modal ref=\"caseDetailModalRef\" @edit=\"showEditCaseModal\" />\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, onMounted, watch } from 'vue'\nimport { getCaseList, searchCases, addCase, updateCase, deleteCase as deleteCaseApi, getCaseStatistics } from '@/api/case'\n\n// 导入组件\nimport CaseStatistics from '@/components/case/CaseStatistics.vue'\nimport CaseSearch from '@/components/case/CaseSearch.vue'\nimport CaseList from '@/components/case/CaseList.vue'\nimport Pagination from '@/components/case/Pagination.vue'\nimport AddCaseModal from '@/components/case/modals/AddCaseModal.vue'\nimport EditCaseModal from '@/components/case/modals/EditCaseModal.vue'\nimport DeleteCaseModal from '@/components/case/modals/DeleteCaseModal.vue'\nimport CaseDetailModal from '@/components/case/modals/CaseDetailModal.vue'\n\nexport default {\n  name: 'CaseManagement',\n  components: {\n    CaseStatistics,\n    CaseSearch,\n    CaseList,\n    Pagination,\n    AddCaseModal,\n    EditCaseModal,\n    DeleteCaseModal,\n    CaseDetailModal\n  },\n  setup() {\n    // 状态变量\n    const loading = ref(false)\n    const statisticsLoading = ref(false)\n    const showAdvancedSearch = ref(false)\n    const cases = ref([])\n    const statistics = ref({\n      totalCases: 0,\n      criminalCases: 0,\n      civilCases: 0,\n      administrativeCases: 0,\n      investigatingCases: 0,\n      inTrialCases: 0,\n      closedCases: 0\n    })\n    \n    // 分页相关\n    const currentPage = ref(1)\n    const pageSize = ref(10)\n    const totalItems = ref(0)\n    const totalPages = ref(0)\n    \n    // 搜索表单\n    const searchForm = reactive({\n      keyword: '',\n      caseType: '',\n      status: '',\n      startDateFrom: '',\n      startDateTo: '',\n      createdAtFrom: '',\n      createdAtTo: '',\n      sortBy: 'createdAt_desc',\n      page: 1,\n      size: pageSize.value\n    })\n    \n    // 模态框引用\n    const addCaseModalRef = ref(null)\n    const editCaseModalRef = ref(null)\n    const deleteCaseModalRef = ref(null)\n    const caseDetailModalRef = ref(null)\n    \n    // 加载案件列表\n    const loadCases = async () => {\n      loading.value = true\n      try {\n        const response = await getCaseList()\n        if (response.data && response.data.code === 200) {\n          cases.value = response.data.data || []\n          // 确保totalItems正确设置为案件数量\n          totalItems.value = cases.value.length\n        } else {\n          console.error('加载案件列表失败:', response.data ? response.data.msg : '未知错误')\n        }\n      } catch (error) {\n        console.error('加载案件列表失败:', error)\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    // 加载案件统计数据\n    const loadStatistics = async () => {\n      statisticsLoading.value = true\n      try {\n        const response = await getCaseStatistics()\n        if (response.data && response.data.code === 200) {\n          statistics.value = response.data.data || {\n            totalCases: 0,\n            criminalCases: 0,\n            civilCases: 0,\n            administrativeCases: 0,\n            investigatingCases: 0,\n            inTrialCases: 0,\n            closedCases: 0\n          }\n        } else {\n          console.error('加载案件统计失败:', response.data ? response.data.msg : '未知错误')\n        }\n      } catch (error) {\n        console.error('加载案件统计失败:', error)\n      } finally {\n        statisticsLoading.value = false\n      }\n    }\n    \n    // 搜索案件\n    const searchCasesData = async () => {\n      console.log('开始执行searchCasesData方法')\n      loading.value = true\n      try {\n        // 构建搜索参数\n        const params = { ...searchForm }\n        \n        // 确保使用当前的 pageSize 值，并且是数字类型\n        params.size = Number(pageSize.value)\n        params.page = Number(params.page)\n        \n        // 将 keyword 参数重命名为 q，以匹配后端 API 期望的参数名\n        if (params.keyword !== undefined) {\n          params.q = params.keyword\n          delete params.keyword\n        }\n        \n        // 设置默认排序\n        params.sortField = 'createdAt'\n        params.sortOrder = 'desc'\n        delete params.sortBy\n        \n        // 调试：检查参数是否正确\n        console.log('searchForm:', searchForm)\n        console.log('params:', params)\n        \n        console.log('准备发送API请求，参数:', params)\n        const response = await searchCases(params)\n        console.log('API响应:', response)\n        \n        console.log('处理API响应数据:', response)\n        if (response.data) {\n          console.log('响应数据:', response.data)\n          if (response.data.code === 200) {\n            const result = response.data.data\n            console.log('结果数据:', result)\n            cases.value = result.records || []\n            // 确保totalItems正确设置为案件数量\n            totalItems.value = result.total !== undefined ? result.total : cases.value.length\n            totalPages.value = result.pages || 0\n            currentPage.value = result.current || 1\n          } else {\n            console.error('搜索案件失败:', response.data.msg || '未知错误')\n          }\n        } else {\n          console.error('搜索案件失败: 响应数据为空')\n        }\n      } catch (error) {\n        console.error('搜索案件失败:', error)\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    // 搜索案件（用于搜索按钮点击事件）\n    const handleSearch = (formData) => {\n      console.log('CaseManagement收到搜索事件，接收到的数据:', formData)\n      // 将CaseSearch组件传来的keyword字段映射到searchForm的q字段\n      if (formData) {\n        // 检查formData是否包含keyword属性\n        console.log('formData包含keyword属性:', Object.prototype.hasOwnProperty.call(formData, 'keyword'))\n        console.log('formData.keyword值:', formData.keyword)\n        \n        // 使用q作为参数名，与后端API保持一致\n        searchForm.q = formData.keyword || ''\n        delete searchForm.keyword // 删除keyword参数\n        \n        searchForm.caseType = formData.caseType || ''\n        searchForm.status = formData.status || ''\n        searchForm.startDateFrom = formData.startDateFrom || ''\n        searchForm.startDateTo = formData.startDateTo || ''\n        searchForm.createdAtFrom = formData.createdAtFrom || ''\n        searchForm.createdAtTo = formData.createdAtTo || ''\n      }\n      console.log('处理后的searchForm:', { ...searchForm })\n      searchForm.page = 1 // 重置到第一页\n      searchCasesData()\n    }\n    \n    // 重置搜索\n    const resetSearch = (formData) => {\n      // 重置搜索表单\n      if (formData) {\n        // 如果CaseSearch组件传来了重置后的表单数据，使用它\n        searchForm.keyword = formData.keyword || ''\n        delete searchForm.q // 删除旧的q参数\n        \n        searchForm.caseType = formData.caseType || ''\n        searchForm.status = formData.status || ''\n        searchForm.startDateFrom = formData.startDateFrom || ''\n        searchForm.startDateTo = formData.startDateTo || ''\n        searchForm.createdAtFrom = formData.createdAtFrom || ''\n        searchForm.createdAtTo = formData.createdAtTo || ''\n      } else {\n        // 否则清空所有搜索条件\n        searchForm.keyword = ''\n        delete searchForm.q // 删除旧的q参数\n        \n        searchForm.caseType = ''\n        searchForm.status = ''\n        searchForm.startDateFrom = ''\n        searchForm.startDateTo = ''\n        searchForm.createdAtFrom = ''\n        searchForm.createdAtTo = ''\n      }\n      // 不再使用这个循环，因为它会清除所有字段，包括我们刚设置的keyword\n      // 而是明确指定需要保留的字段\n      searchForm.page = 1 // 重置到第一页\n      searchCasesData() // 使用searchCasesData函数执行搜索\n    }\n    \n    // 切换高级搜索\n    const toggleAdvancedSearch = (value) => {\n      // 如果传入了值，使用传入的值；否则切换当前值\n      showAdvancedSearch.value = value !== undefined ? value : !showAdvancedSearch.value\n    }\n    \n    // 切换页码\n    const changePage = (page) => {\n      searchForm.page = page\n      searchCasesData()\n    }\n    \n    // 更改每页显示数量\n    const changePageSize = (size) => {\n      if (size) {\n        // 确保 size 是数字类型\n        const numSize = typeof size === 'string' ? parseInt(size) : size\n        pageSize.value = numSize\n      }\n      \n      // 更新搜索表单中的每页数量\n      searchForm.size = Number(pageSize.value) // 确保是数字类型\n      \n      // 重置到第一页\n      searchForm.page = 1\n      \n      // 重新加载数据\n      searchCasesData()\n    }\n    \n    // 显示添加案件模态框\n    const showAddCaseModal = () => {\n      if (addCaseModalRef.value) {\n        addCaseModalRef.value.showModal()\n      }\n    }\n    \n    // 显示编辑案件模态框\n    const showEditCaseModal = (caseItem) => {\n      if (editCaseModalRef.value) {\n        editCaseModalRef.value.showModal(caseItem)\n      }\n    }\n    \n    // 确认删除案件\n    const confirmDeleteCase = (caseItem) => {\n      if (deleteCaseModalRef.value) {\n        deleteCaseModalRef.value.showModal(caseItem)\n      }\n    }\n    \n    // 查看案件详情\n    const viewCaseDetail = (caseId) => {\n      if (caseDetailModalRef.value) {\n        caseDetailModalRef.value.showModal(caseId)\n      }\n    }\n    \n    // 提交添加案件\n    const submitAddCase = async (formData) => {\n      try {\n        const response = await addCase(formData)\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData()\n          loadStatistics()\n        } else {\n          console.error('添加案件失败:', response.data ? response.data.msg : '未知错误')\n        }\n      } catch (error) {\n        console.error('添加案件失败:', error)\n      }\n    }\n    \n    // 提交编辑案件\n    const submitEditCase = async (formData) => {\n      try {\n        const response = await updateCase(formData)\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData()\n          loadStatistics()\n        } else {\n          console.error('更新案件失败:', response.data ? response.data.msg : '未知错误')\n        }\n      } catch (error) {\n        console.error('更新案件失败:', error)\n      }\n    }\n    \n    // 删除案件\n    const deleteCase = async (caseId) => {\n      try {\n        const response = await deleteCaseApi(caseId)\n        if (response.data && response.data.code === 200) {\n          // 重新加载数据\n          searchCasesData()\n          loadStatistics()\n        } else {\n          console.error('删除案件失败:', response.data ? response.data.msg : '未知错误')\n        }\n      } catch (error) {\n        console.error('删除案件失败:', error)\n      }\n    }\n    \n    // 组件挂载时加载数据\n    onMounted(() => {\n      searchCasesData() // 使用searchCasesData方法替代loadCases方法\n      loadStatistics()\n    })\n    \n    // 监听页码变化\n    watch(currentPage, (newPage) => {\n      searchForm.page = newPage\n      searchCasesData() // 当页码变化时，重新加载数据\n    })\n    \n    return {\n      // 状态\n      loading,\n      statisticsLoading,\n      showAdvancedSearch,\n      cases,\n      statistics,\n      \n      // 分页\n      currentPage,\n      pageSize,\n      totalItems,\n      totalPages,\n      \n      // 表单\n      searchForm,\n      \n      // 模态框引用\n      addCaseModalRef,\n      editCaseModalRef,\n      deleteCaseModalRef,\n      caseDetailModalRef,\n      \n      // 方法\n      toggleAdvancedSearch,\n      searchCases: handleSearch,\n      resetSearch,\n      changePage,\n      changePageSize,\n      showAddCaseModal,\n      showEditCaseModal,\n      confirmDeleteCase,\n      viewCaseDetail,\n      submitAddCase,\n      submitEditCase,\n      deleteCase,\n      loadCases\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container-fluid {\n  max-width: 1600px;\n  margin: 0 auto;\n}\n\n.display-6 {\n  font-size: 2rem;\n}\n\n.btn-success {\n  background: linear-gradient(to right, #28a745, #20c997);\n  border: none;\n  box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);\n}\n\n.btn-success:hover {\n  background: linear-gradient(to right, #218838, #1e9e7f);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);\n}\n\n.btn-outline-primary {\n  color: #4a6cf7;\n  border-color: #4a6cf7;\n}\n\n.btn-outline-primary:hover {\n  background-color: rgba(74, 108, 247, 0.1);\n  color: #2651f0;\n  border-color: #2651f0;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}