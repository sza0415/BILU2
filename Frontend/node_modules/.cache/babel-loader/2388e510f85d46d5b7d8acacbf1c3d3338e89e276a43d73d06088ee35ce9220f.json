{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from 'axios';\nexport default {\n  name: 'TemplateManagement',\n  data() {\n    return {\n      activeTab: 'general',\n      showAddModal: false,\n      showImportModal: false,\n      editingTemplate: null,\n      selectedFile: null,\n      loading: false,\n      templateForm: {\n        templateType: '',\n        question: '',\n        sortOrder: 0\n      },\n      templateTypes: [{\n        key: 'general',\n        name: '一般保密审查'\n      }, {\n        key: 'secret',\n        name: '机密级审查'\n      }, {\n        key: 'topsecret',\n        name: '绝密级审查'\n      }, {\n        key: 'special',\n        name: '特殊审查'\n      }],\n      templates: {\n        general: [],\n        secret: [],\n        topsecret: [],\n        special: []\n      },\n      // API基础URL\n      apiBaseUrl: 'http://localhost:8080/api/module/secrecy'\n    };\n  },\n  methods: {\n    // API调用方法\n    async loadTemplates(templateType = null) {\n      try {\n        this.loading = true;\n        const params = templateType ? {\n          templateType\n        } : {};\n        const response = await axios.get(`${this.apiBaseUrl}/get_templates`, {\n          params\n        });\n        if (response.data.code === 200) {\n          const templates = response.data.data;\n          if (templateType) {\n            this.templates[templateType] = templates;\n          } else {\n            // 按类型分组\n            this.templateTypes.forEach(type => {\n              this.templates[type.key] = templates.filter(t => t.templateType === type.key);\n            });\n          }\n        } else {\n          this.$message.error(response.data.message || '加载模板失败');\n        }\n      } catch (error) {\n        console.error('加载模板失败:', error);\n        this.$message.error('加载模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async saveTemplate() {\n      try {\n        if (!this.templateForm.templateType || !this.templateForm.question) {\n          this.$message.warning('请填写完整信息');\n          return;\n        }\n        this.loading = true;\n        let response;\n        if (this.editingTemplate) {\n          // 编辑模板\n          response = await axios.put(`${this.apiBaseUrl}/${this.editingTemplate.id}/edit`, {\n            templateType: this.templateForm.templateType,\n            question: this.templateForm.question,\n            sortOrder: this.templateForm.sortOrder || 0\n          });\n        } else {\n          // 添加模板\n          response = await axios.post(`${this.apiBaseUrl}/add_with_category`, null, {\n            params: {\n              templateType: this.templateForm.templateType,\n              question: this.templateForm.question,\n              sortOrder: this.templateForm.sortOrder || 0\n            }\n          });\n        }\n        if (response.data.code === 200) {\n          this.$message.success(this.editingTemplate ? '更新成功' : '添加成功');\n          this.closeAddModal();\n          await this.loadTemplates(this.templateForm.templateType);\n        } else {\n          this.$message.error(response.data.message || '操作失败');\n        }\n      } catch (error) {\n        console.error('保存模板失败:', error);\n        this.$message.error('保存模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async deleteTemplate(id) {\n      if (!confirm('确定要删除这个模板吗？')) {\n        return;\n      }\n      try {\n        this.loading = true;\n        const response = await axios.delete(`${this.apiBaseUrl}/delete`, {\n          params: {\n            id\n          }\n        });\n        if (response.data.code === 200) {\n          this.$message.success('删除成功');\n          await this.loadTemplates(this.activeTab);\n        } else {\n          this.$message.error(response.data.message || '删除失败');\n        }\n      } catch (error) {\n        console.error('删除模板失败:', error);\n        this.$message.error('删除模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async deleteTemplateType() {\n      const typeName = this.getCurrentTypeName();\n      if (!confirm(`确定要删除整个\"${typeName}\"类型的所有模板吗？`)) {\n        return;\n      }\n      try {\n        this.loading = true;\n        const response = await axios.delete(`${this.apiBaseUrl}/delete_type`, {\n          params: {\n            templateType: this.activeTab\n          }\n        });\n        if (response.data.code === 200) {\n          this.$message.success('删除类型成功');\n          await this.loadTemplates(this.activeTab);\n        } else {\n          this.$message.error(response.data.message || '删除失败');\n        }\n      } catch (error) {\n        console.error('删除模板类型失败:', error);\n        this.$message.error('删除模板类型失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async importTemplates() {\n      if (!this.selectedFile) {\n        this.$message.warning('请选择文件');\n        return;\n      }\n      try {\n        this.loading = true;\n        const formData = new FormData();\n        formData.append('file', this.selectedFile);\n        let response;\n        if (this.selectedFile.name.endsWith('.csv')) {\n          response = await axios.post(`${this.apiBaseUrl}/import_csv`, formData, {\n            headers: {\n              'Content-Type': 'multipart/form-data'\n            }\n          });\n        } else {\n          response = await axios.post(`${this.apiBaseUrl}/import`, formData, {\n            headers: {\n              'Content-Type': 'multipart/form-data'\n            }\n          });\n        }\n        if (response.data.code === 200) {\n          this.$message.success(`成功导入${response.data.data}条数据`);\n          this.showImportModal = false;\n          this.selectedFile = null;\n          await this.loadTemplates();\n        } else {\n          this.$message.error(response.data.message || '导入失败');\n        }\n      } catch (error) {\n        console.error('导入模板失败:', error);\n        this.$message.error('导入模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async exportTemplates() {\n      try {\n        this.loading = true;\n        const params = this.activeTab ? {\n          templateType: this.activeTab\n        } : {};\n        const response = await axios.get(`${this.apiBaseUrl}/export`, {\n          params,\n          responseType: 'blob'\n        });\n\n        // 创建下载链接\n        const blob = new Blob([response.data], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        });\n        const url = window.URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = `secrecy_templates_${this.activeTab || 'all'}.xlsx`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        window.URL.revokeObjectURL(url);\n        this.$message.success('导出成功');\n      } catch (error) {\n        console.error('导出模板失败:', error);\n        this.$message.error('导出模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    handleFileSelect(event) {\n      this.selectedFile = event.target.files[0];\n    },\n    closeAddModal() {\n      this.showAddModal = false;\n      this.editingTemplate = null;\n      this.templateForm = {\n        templateType: '',\n        question: '',\n        sortOrder: 0\n      };\n    },\n    // UI辅助方法\n    getCurrentTemplates() {\n      return this.templates[this.activeTab] || [];\n    },\n    getCurrentTypeName() {\n      const type = this.templateTypes.find(t => t.key === this.activeTab);\n      return type ? type.name : '';\n    },\n    getTemplateCount(typeKey) {\n      return this.templates[typeKey] ? this.templates[typeKey].length : 0;\n    },\n    editTemplate(template) {\n      this.editingTemplate = template;\n      this.templateForm = {\n        templateType: this.activeTab,\n        question: template.question,\n        sortOrder: template.sortOrder\n      };\n      this.showAddModal = true;\n    },\n    formatDate(dateStr) {\n      return new Date(dateStr).toLocaleString('zh-CN');\n    }\n  },\n  watch: {\n    activeTab(newTab) {\n      // 当切换标签时，如果该类型的模板还没有加载，则加载\n      if (this.templates[newTab].length === 0) {\n        this.loadTemplates(newTab);\n      }\n    }\n  },\n  async mounted() {\n    console.log('模版管理页面已加载');\n    // 页面加载时获取所有模板数据\n    await this.loadTemplates();\n  }\n};","map":{"version":3,"names":["axios","name","data","activeTab","showAddModal","showImportModal","editingTemplate","selectedFile","loading","templateForm","templateType","question","sortOrder","templateTypes","key","templates","general","secret","topsecret","special","apiBaseUrl","methods","loadTemplates","params","response","get","code","forEach","type","filter","t","$message","error","message","console","saveTemplate","warning","put","id","post","success","closeAddModal","deleteTemplate","confirm","delete","deleteTemplateType","typeName","getCurrentTypeName","importTemplates","formData","FormData","append","endsWith","headers","exportTemplates","responseType","blob","Blob","url","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","handleFileSelect","event","target","files","getCurrentTemplates","find","getTemplateCount","typeKey","length","editTemplate","template","formatDate","dateStr","Date","toLocaleString","watch","newTab","mounted","log"],"sources":["/Users/sunziang/IdeaProjects/backend_bilu/bilu_backend2/src/views/TemplateManagement.vue"],"sourcesContent":["<template>\n  <div class=\"container mt-4\">\n    <!-- 页面标题区域 -->\n    <div class=\"row mb-4\">\n      <div class=\"col-12 text-center\">\n        <h2 class=\"display-5 fw-bold text-primary\">保密问答模板管理</h2>\n        <p class=\"text-muted\">管理和维护各类保密审查问题模板</p>\n      </div>\n    </div>\n    \n    <div class=\"row\">\n      <div class=\"col-12\">\n        <div class=\"card border-0 shadow-lg rounded-4 overflow-hidden\">\n          <!-- 操作按钮区域 -->\n          <div class=\"card-header bg-white border-0 p-4\">\n            <div class=\"d-flex justify-content-between align-items-center\">\n              <div>\n                <h4 class=\"fw-bold text-primary mb-0\">\n                  <i class=\"bi bi-gear me-2\"></i>模板管理\n                </h4>\n              </div>\n              <div class=\"btn-group\">\n                <button class=\"btn btn-primary\" @click=\"showAddModal = true\" :disabled=\"loading\">\n                  <i class=\"bi bi-plus-circle me-2\"></i>添加模板\n                </button>\n                <button class=\"btn btn-success\" @click=\"showImportModal = true\" :disabled=\"loading\">\n                  <i class=\"bi bi-upload me-2\"></i>导入模板\n                </button>\n                <button class=\"btn btn-info\" @click=\"exportTemplates\" :disabled=\"loading\">\n                  <i class=\"bi bi-download me-2\"></i>导出模板\n                </button>\n              </div>\n            </div>\n          </div>\n          \n          <!-- 标签导航 -->\n          <div class=\"card-header bg-white border-0 p-0\">\n            <ul class=\"nav nav-tabs nav-fill custom-tabs\" role=\"tablist\">\n              <li class=\"nav-item\" role=\"presentation\" v-for=\"type in templateTypes\" :key=\"type.key\">\n                <button \n                  class=\"nav-link\" \n                  :class=\"{ active: activeTab === type.key }\"\n                  @click=\"activeTab = type.key\"\n                  type=\"button\" \n                  role=\"tab\"\n                >\n                  <i class=\"fas fa-shield-alt me-2\"></i>{{ type.name }}\n                  <span class=\"badge bg-primary rounded-pill ms-2\">{{ getTemplateCount(type.key) }}</span>\n                </button>\n              </li>\n            </ul>\n          </div>\n          \n          <!-- 标签内容 -->\n          <div class=\"card-body p-4\">\n            <div class=\"tab-content\">\n              <div class=\"tab-pane fade show active\">\n                <div class=\"d-flex justify-content-between align-items-center mb-4\">\n                  <div>\n                    <h3 class=\"fw-bold text-primary mb-0\">\n                      <i class=\"fas fa-list-alt me-2\"></i>{{ getCurrentTypeName() }}\n                      <span class=\"badge bg-primary rounded-pill ms-2\">{{ getCurrentTemplates().length }}</span>\n                    </h3>\n                    <div class=\"border-bottom border-2 border-primary mt-2\" style=\"width: 50px;\"></div>\n                  </div>\n                  <div class=\"btn-group\">\n                    <button \n                      class=\"btn btn-primary px-4 py-2 d-flex align-items-center shadow-sm\" \n                      @click=\"showAddModal = true\"\n                      :disabled=\"loading\"\n                    >\n                      <i class=\"fas fa-plus-circle me-2\"></i> 添加问题\n                    </button>\n                    <button \n                      v-if=\"getCurrentTemplates().length > 0\"\n                      class=\"btn btn-danger px-4 py-2 d-flex align-items-center shadow-sm\" \n                      @click=\"deleteTemplateType\"\n                      :disabled=\"loading\"\n                    >\n                      <i class=\"fas fa-trash-alt me-2\"></i> 删除类型\n                    </button>\n                  </div>\n                </div>\n                \n                <!-- 问题列表 -->\n                <div class=\"table-responsive rounded-4 shadow-sm\">\n                  <table class=\"table table-hover mb-0\">\n                    <thead>\n                      <tr class=\"bg-light\">\n                        <th width=\"5%\" class=\"py-3 ps-4 text-primary\">序号</th>\n                        <th width=\"80%\" class=\"py-3 text-primary\">问题</th>\n                        <th width=\"15%\" class=\"py-3 text-center text-primary\">操作</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr \n                        v-for=\"(template, index) in getCurrentTemplates()\" \n                        :key=\"template.id\" \n                        class=\"border-bottom question-item\"\n                      >\n                        <td class=\"py-3 ps-4 fw-bold text-muted\">{{ index + 1 }}</td>\n                        <td class=\"py-3 question-text\">{{ template.question }}</td>\n                        <td class=\"py-3 text-center\">\n                          <div class=\"btn-group\">\n                            <button \n                              class=\"btn btn-sm btn-outline-primary edit-btn\" \n                              @click=\"editTemplate(template)\"\n                              :disabled=\"loading\"\n                            >\n                              <i class=\"fas fa-edit me-1\"></i> 编辑\n                            </button>\n                            <button \n                              class=\"btn btn-sm btn-outline-danger delete-btn\" \n                              @click=\"deleteTemplate(template.id)\"\n                              :disabled=\"loading\"\n                            >\n                              <i class=\"fas fa-trash-alt me-1\"></i> 删除\n                            </button>\n                          </div>\n                        </td>\n                      </tr>\n                      <tr v-if=\"getCurrentTemplates().length === 0\">\n                        <td colspan=\"3\" class=\"text-center py-5\">\n                          <div class=\"empty-state\">\n                            <i class=\"fas fa-inbox fa-3x mb-3 text-secondary opacity-50\"></i>\n                            <h5 class=\"text-secondary\">暂无问题模板</h5>\n                            <p class=\"text-muted\">点击\"添加问题\"按钮创建新的问题模板</p>\n                          </div>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 添加/编辑模板模态框 -->\n    <div class=\"modal fade\" :class=\"{ show: showAddModal }\" :style=\"{ display: showAddModal ? 'block' : 'none' }\" tabindex=\"-1\">\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">\n              <i class=\"bi bi-plus-circle me-2\"></i>{{ editingTemplate ? '编辑模板' : '添加模板' }}\n            </h5>\n            <button type=\"button\" class=\"btn-close\" @click=\"closeAddModal\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <form @submit.prevent=\"saveTemplate\">\n              <div class=\"mb-3\">\n                <label for=\"templateType\" class=\"form-label\">模板类型</label>\n                <select class=\"form-select\" id=\"templateType\" v-model=\"templateForm.templateType\" required>\n                  <option value=\"\">请选择模板类型</option>\n                  <option v-for=\"type in templateTypes\" :key=\"type.key\" :value=\"type.key\">\n                    {{ type.name }}\n                  </option>\n                </select>\n              </div>\n              <div class=\"mb-3\">\n                <label for=\"question\" class=\"form-label\">问题内容</label>\n                <textarea \n                  class=\"form-control\" \n                  id=\"question\" \n                  rows=\"4\" \n                  v-model=\"templateForm.question\" \n                  placeholder=\"请输入问题内容\"\n                  required\n                ></textarea>\n              </div>\n              <div class=\"mb-3\">\n                <label for=\"sortOrder\" class=\"form-label\">排序</label>\n                <input \n                  type=\"number\" \n                  class=\"form-control\" \n                  id=\"sortOrder\" \n                  v-model=\"templateForm.sortOrder\" \n                  placeholder=\"排序号（数字越小越靠前）\"\n                />\n              </div>\n            </form>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"closeAddModal\" :disabled=\"loading\">取消</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"saveTemplate\" :disabled=\"loading\">\n              <i class=\"bi bi-check-circle me-2\"></i>{{ loading ? '保存中...' : '保存' }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 导入模板模态框 -->\n    <div class=\"modal fade\" :class=\"{ show: showImportModal }\" :style=\"{ display: showImportModal ? 'block' : 'none' }\" tabindex=\"-1\">\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">\n              <i class=\"bi bi-upload me-2\"></i>导入模板\n            </h5>\n            <button type=\"button\" class=\"btn-close\" @click=\"showImportModal = false\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <div class=\"mb-3\">\n              <label for=\"importFile\" class=\"form-label\">选择文件</label>\n              <input \n                type=\"file\" \n                class=\"form-control\" \n                id=\"importFile\" \n                @change=\"handleFileSelect\"\n                accept=\".xlsx,.xls,.csv\"\n              />\n              <div class=\"form-text\">支持Excel (.xlsx, .xls) 和CSV (.csv) 格式</div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"showImportModal = false\" :disabled=\"loading\">取消</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"importTemplates\" :disabled=\"!selectedFile || loading\">\n              <i class=\"bi bi-upload me-2\"></i>{{ loading ? '导入中...' : '导入' }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 模态框背景 -->\n    <div v-if=\"showAddModal || showImportModal\" class=\"modal-backdrop fade show\"></div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\n\nexport default {\n  name: 'TemplateManagement',\n  data() {\n    return {\n      activeTab: 'general',\n      showAddModal: false,\n      showImportModal: false,\n      editingTemplate: null,\n      selectedFile: null,\n      loading: false,\n      templateForm: {\n        templateType: '',\n        question: '',\n        sortOrder: 0\n      },\n      templateTypes: [\n        { key: 'general', name: '一般保密审查' },\n        { key: 'secret', name: '机密级审查' },\n        { key: 'topsecret', name: '绝密级审查' },\n        { key: 'special', name: '特殊审查' }\n      ],\n      templates: {\n        general: [],\n        secret: [],\n        topsecret: [],\n        special: []\n      },\n      // API基础URL\n      apiBaseUrl: 'http://localhost:8080/api/module/secrecy'\n    }\n  },\n  methods: {\n    // API调用方法\n    async loadTemplates(templateType = null) {\n      try {\n        this.loading = true;\n        const params = templateType ? { templateType } : {};\n        const response = await axios.get(`${this.apiBaseUrl}/get_templates`, { params });\n        \n        if (response.data.code === 200) {\n          const templates = response.data.data;\n          if (templateType) {\n            this.templates[templateType] = templates;\n          } else {\n            // 按类型分组\n            this.templateTypes.forEach(type => {\n              this.templates[type.key] = templates.filter(t => t.templateType === type.key);\n            });\n          }\n        } else {\n          this.$message.error(response.data.message || '加载模板失败');\n        }\n      } catch (error) {\n        console.error('加载模板失败:', error);\n        this.$message.error('加载模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async saveTemplate() {\n      try {\n        if (!this.templateForm.templateType || !this.templateForm.question) {\n          this.$message.warning('请填写完整信息');\n          return;\n        }\n\n        this.loading = true;\n        let response;\n        \n        if (this.editingTemplate) {\n          // 编辑模板\n          response = await axios.put(`${this.apiBaseUrl}/${this.editingTemplate.id}/edit`, {\n            templateType: this.templateForm.templateType,\n            question: this.templateForm.question,\n            sortOrder: this.templateForm.sortOrder || 0\n          });\n        } else {\n          // 添加模板\n          response = await axios.post(`${this.apiBaseUrl}/add_with_category`, null, {\n            params: {\n              templateType: this.templateForm.templateType,\n              question: this.templateForm.question,\n              sortOrder: this.templateForm.sortOrder || 0\n            }\n          });\n        }\n\n        if (response.data.code === 200) {\n          this.$message.success(this.editingTemplate ? '更新成功' : '添加成功');\n          this.closeAddModal();\n          await this.loadTemplates(this.templateForm.templateType);\n        } else {\n          this.$message.error(response.data.message || '操作失败');\n        }\n      } catch (error) {\n        console.error('保存模板失败:', error);\n        this.$message.error('保存模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async deleteTemplate(id) {\n      if (!confirm('确定要删除这个模板吗？')) {\n        return;\n      }\n\n      try {\n        this.loading = true;\n        const response = await axios.delete(`${this.apiBaseUrl}/delete`, {\n          params: { id }\n        });\n\n        if (response.data.code === 200) {\n          this.$message.success('删除成功');\n          await this.loadTemplates(this.activeTab);\n        } else {\n          this.$message.error(response.data.message || '删除失败');\n        }\n      } catch (error) {\n        console.error('删除模板失败:', error);\n        this.$message.error('删除模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async deleteTemplateType() {\n      const typeName = this.getCurrentTypeName();\n      if (!confirm(`确定要删除整个\"${typeName}\"类型的所有模板吗？`)) {\n        return;\n      }\n\n      try {\n        this.loading = true;\n        const response = await axios.delete(`${this.apiBaseUrl}/delete_type`, {\n          params: { templateType: this.activeTab }\n        });\n\n        if (response.data.code === 200) {\n          this.$message.success('删除类型成功');\n          await this.loadTemplates(this.activeTab);\n        } else {\n          this.$message.error(response.data.message || '删除失败');\n        }\n      } catch (error) {\n        console.error('删除模板类型失败:', error);\n        this.$message.error('删除模板类型失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async importTemplates() {\n      if (!this.selectedFile) {\n        this.$message.warning('请选择文件');\n        return;\n      }\n\n      try {\n        this.loading = true;\n        const formData = new FormData();\n        formData.append('file', this.selectedFile);\n\n        let response;\n        if (this.selectedFile.name.endsWith('.csv')) {\n          response = await axios.post(`${this.apiBaseUrl}/import_csv`, formData, {\n            headers: { 'Content-Type': 'multipart/form-data' }\n          });\n        } else {\n          response = await axios.post(`${this.apiBaseUrl}/import`, formData, {\n            headers: { 'Content-Type': 'multipart/form-data' }\n          });\n        }\n\n        if (response.data.code === 200) {\n          this.$message.success(`成功导入${response.data.data}条数据`);\n          this.showImportModal = false;\n          this.selectedFile = null;\n          await this.loadTemplates();\n        } else {\n          this.$message.error(response.data.message || '导入失败');\n        }\n      } catch (error) {\n        console.error('导入模板失败:', error);\n        this.$message.error('导入模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async exportTemplates() {\n      try {\n        this.loading = true;\n        const params = this.activeTab ? { templateType: this.activeTab } : {};\n        const response = await axios.get(`${this.apiBaseUrl}/export`, {\n          params,\n          responseType: 'blob'\n        });\n\n        // 创建下载链接\n        const blob = new Blob([response.data], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        });\n        const url = window.URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = `secrecy_templates_${this.activeTab || 'all'}.xlsx`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        window.URL.revokeObjectURL(url);\n\n        this.$message.success('导出成功');\n      } catch (error) {\n        console.error('导出模板失败:', error);\n        this.$message.error('导出模板失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    handleFileSelect(event) {\n      this.selectedFile = event.target.files[0];\n    },\n\n    closeAddModal() {\n      this.showAddModal = false;\n      this.editingTemplate = null;\n      this.templateForm = {\n        templateType: '',\n        question: '',\n        sortOrder: 0\n      };\n    },\n\n    // UI辅助方法\n    getCurrentTemplates() {\n      return this.templates[this.activeTab] || [];\n    },\n\n    getCurrentTypeName() {\n      const type = this.templateTypes.find(t => t.key === this.activeTab);\n      return type ? type.name : '';\n    },\n\n    getTemplateCount(typeKey) {\n      return this.templates[typeKey] ? this.templates[typeKey].length : 0;\n    },\n\n    editTemplate(template) {\n      this.editingTemplate = template;\n      this.templateForm = {\n        templateType: this.activeTab,\n        question: template.question,\n        sortOrder: template.sortOrder\n      };\n      this.showAddModal = true;\n    },\n\n    formatDate(dateStr) {\n      return new Date(dateStr).toLocaleString('zh-CN');\n    }\n  },\n  watch: {\n    activeTab(newTab) {\n      // 当切换标签时，如果该类型的模板还没有加载，则加载\n      if (this.templates[newTab].length === 0) {\n        this.loadTemplates(newTab);\n      }\n    }\n  },\n  async mounted() {\n    console.log('模版管理页面已加载');\n    // 页面加载时获取所有模板数据\n    await this.loadTemplates();\n  }\n}\n</script>\n\n<style scoped>\n.template-card {\n  transition: all 0.3s ease;\n}\n\n.template-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n}\n\n.btn {\n  transition: all 0.3s ease;\n}\n\n.btn:hover {\n  transform: translateY(-1px);\n}\n\n.nav-tabs .nav-link {\n  border: none;\n  border-radius: 0;\n  color: #6c757d;\n  font-weight: 500;\n  padding: 1rem 1.5rem;\n  transition: all 0.3s ease;\n}\n\n.nav-tabs .nav-link.active {\n  background-color: #0d6efd;\n  color: white;\n  border-bottom: 3px solid #0d6efd;\n}\n\n.nav-tabs .nav-link:hover {\n  background-color: rgba(13, 110, 253, 0.1);\n  color: #0d6efd;\n}\n\n.modal {\n  background-color: rgba(0, 0, 0, 0.5);\n}\n\n.form-control:focus, .form-select:focus {\n  border-color: #0d6efd;\n  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);\n}\n\n.table th {\n  font-weight: 600;\n  border-bottom: 2px solid #dee2e6;\n  background-color: #f8f9fa;\n}\n\n.badge {\n  font-size: 0.75rem;\n}\n\n.empty-state {\n  padding: 3rem;\n  text-align: center;\n}\n\n.stats-card {\n  transition: all 0.3s ease;\n}\n\n.stats-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n}\n\n.stats-icon {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  margin: 0 auto;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}